<!DOCTYPE html>
<html lang="en,zh-CN,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-material.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xigou.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="intruduction                          “Tell me and I forget. Show me and I remember. Involve me and I understand.”Chinese proverb                           I read the Computer Networks: Top-Down Appro">
<meta name="keywords" content="Computer Network">
<meta property="og:type" content="article">
<meta property="og:title" content="Wireshark experements of &lt;i&gt;Computer Networks: Top-Down Approach&lt;&#x2F;i&gt;">
<meta property="og:url" content="https://xigou.github.io/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/index.html">
<meta property="og:site_name" content="Land of Free">
<meta property="og:description" content="intruduction                          “Tell me and I forget. Show me and I remember. Involve me and I understand.”Chinese proverb                           I read the Computer Networks: Top-Down Appro">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2021-12-13T23:56:11.818Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wireshark experements of &lt;i&gt;Computer Networks: Top-Down Approach&lt;&#x2F;i&gt;">
<meta name="twitter:description" content="intruduction                          “Tell me and I forget. Show me and I remember. Involve me and I understand.”Chinese proverb                           I read the Computer Networks: Top-Down Appro">

<link rel="canonical" href="https://xigou.github.io/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Wireshark experements of <i>Computer Networks: Top-Down Approach</i> | Land of Free</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Land of Free" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Land of Free</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">John's Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://xigou.github.io/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John.Jersey">
      <meta itemprop="description" content="一个不愿意透露姓名的粉丝">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Land of Free">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Wireshark experements of <i>Computer Networks: Top-Down Approach</i>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-04 21:35:04" itemprop="dateCreated datePublished" datetime="2021-09-04T21:35:04+00:00">2021-09-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-12-13 23:56:11" itemprop="dateModified" datetime="2021-12-13T23:56:11+00:00">2021-12-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="intruduction"><a href="#intruduction" class="headerlink" title="intruduction"></a>intruduction</h1><blockquote class="blockquote-center">
            <i class="fa fa-quote-left"></i>
            <p>“Tell me and I forget. Show me and I remember. Involve me and I understand.”<br><em>Chinese proverb</em></p>

            <i class="fa fa-quote-right"></i>
          </blockquote>
<hr>
<p>I read the <em>Computer Networks: Top-Down Approach</em> about 3 years ago preparing for my CN-GRE, after read this book, I learned a lot about computer network, the reading helped me to fill in the blanks on the test paper, but I don’t have the confidence to tell others I know the principles behind computer network, expecially after years of forgetting process.</p>
<p>So I decide to do a wireshark homework in this weekend.</p>
<a id="more"></a>
<h1 id="Experiments"><a href="#Experiments" class="headerlink" title="Experiments"></a>Experiments</h1><h2 id="Basic-skill-capturing-packets-using-Wireshark"><a href="#Basic-skill-capturing-packets-using-Wireshark" class="headerlink" title="Basic skill: capturing packets using Wireshark"></a>Basic skill: capturing packets using Wireshark</h2><p><em>Wiresharks</em> is a powerful tools to capture, mastering it needs much time, but I think knowing three steps below is enough to start these labs:</p>
<ol>
<li>select an interface, and click the “shark fin” icon to start capturing packets;</li>
<li>do something can trigger the protocal you want to observe;</li>
<li>click stop icon to stop capturing and start research.</li>
</ol>
<p>Need to know more, just go to reference<a href="#refer-anchor-1"><sup>1</sup></a>.</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h3 id="The-Basic-HTTP-GET-response-interaction"><a href="#The-Basic-HTTP-GET-response-interaction" class="headerlink" title="The Basic HTTP GET/response interaction"></a>The Basic HTTP GET/response interaction</h3><p>What I did:<br>Open Microsoft Edge browser and open this url:  <a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html</a>.</p>
<p>Captured packets:</p>
<table>
<thead>
<tr>
<th>“No.”</th>
<th>“Time”</th>
<th>“Source”</th>
<th>“Destination”</th>
<th>“Protocol”</th>
<th>“Length”</th>
<th>“Info”</th>
</tr>
</thead>
<tbody>
<tr>
<td>“370872”</td>
<td>“899.553481”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“581”</td>
<td>“GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1 “</td>
</tr>
<tr>
<td>“372140”</td>
<td>“899.824395”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“540”</td>
<td>“HTTP/1.1 200 OK  (text/html)”</td>
</tr>
</tbody>
</table>
<p>Detail of packets:<br>Request:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Frame 370872: 581 bytes on wire (4648 bits), 581 bytes captured (4648 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 17536, Dst Port: 80, Seq: 1, Ack: 1, Len: 527</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1\r\n</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Cache-Control: max-age=0\r\n</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]</span><br><span class="line">    [HTTP request 1/1]</span><br><span class="line">    [Response in frame: 372140]</span><br></pre></td></tr></table></figure></p>
<p>Response:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Frame 372140: 540 bytes on wire (4320 bits), 540 bytes captured (4320 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3</span><br><span class="line">Transmission Control Protocol, Src Port: 80, Dst Port: 17536, Seq: 1, Ack: 528, Len: 486</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    HTTP/1.1 200 OK\r\n</span><br><span class="line">    Date: Sun, 05 Sep 2021 09:03:10 GMT\r\n</span><br><span class="line">    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n</span><br><span class="line">    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n</span><br><span class="line">    ETag: &quot;80-5cb393aaf07a9&quot;\r\n</span><br><span class="line">    Accept-Ranges: bytes\r\n</span><br><span class="line">    Content-Length: 128\r\n</span><br><span class="line">    Keep-Alive: timeout=5, max=100\r\n</span><br><span class="line">    Connection: Keep-Alive\r\n</span><br><span class="line">    Content-Type: text/html; charset=UTF-8\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [HTTP response 1/1]</span><br><span class="line">    [Time since request: 0.270914000 seconds]</span><br><span class="line">    [Request in frame: 370872]</span><br><span class="line">    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]</span><br><span class="line">    File Data: 128 bytes</span><br><span class="line">Line-based text data: text/html (4 lines)</span><br><span class="line">    &lt;html&gt;\n</span><br><span class="line">    Congratulations.  You&apos;ve downloaded the file \n</span><br><span class="line">    http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html!\n</span><br><span class="line">    &lt;/html&gt;\n</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol>
<li><p>Is your browser running HTTP version 1.0, 1.1, or 2?  What version of HTTP is the server running?<br>From the header of request packet, I can see the HTTP version of my browser and server are both HTTP/1.1.</p>
</li>
<li><p>What languages (if any) does your browser indicate that it can accept to the server?<br>It is in the “Accept-Language” of the request packet.</p>
</li>
<li><p>What is the IP address of your computer?  What is the IP address of the gaia.cs.umass.edu server?<br>The Internet Protocal layer indicates my IP(Src) is 192.168.1.3, IP of gaia.cs.umass.edu server(Dst) is 128.119.245.12.</p>
</li>
<li><p>What is the status code returned from the server to your browser?<br>200 OK.</p>
</li>
<li><p>When was the HTML file that you are retrieving last modified at the server?<br>Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n</p>
</li>
<li><p>How many bytes of content are being returned to your browser?<br>540 bytes.</p>
</li>
<li><p>By inspecting the raw data in the packet content window, do you see any headers within the data that are not displayed in the packet-listing window?  If so, name one.<br>Content-Length.</p>
</li>
</ol>
<h3 id="The-HTTP-CONDITIONAL-GET-response-interaction"><a href="#The-HTTP-CONDITIONAL-GET-response-interaction" class="headerlink" title="The HTTP CONDITIONAL GET/response interaction"></a>The HTTP CONDITIONAL GET/response interaction</h3><p>Operations:</p>
<ul>
<li>Enter the following URL into your browser<br><a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html</a><br>Your browser should display a very simple five-line HTML file. </li>
<li>Quickly enter the same URL into your browser again (or simply select the refresh button on your browser)</li>
</ul>
<p>Captured packets:</p>
<table>
<thead>
<tr>
<th>“No.”</th>
<th>“Time”</th>
<th>“Source”</th>
<th>“Destination”</th>
<th>“Protocol”</th>
<th>“Length”</th>
<th>“Info”</th>
</tr>
</thead>
<tbody>
<tr>
<td>“142”</td>
<td>“6.368786”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“555”</td>
<td>“GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1 “</td>
</tr>
<tr>
<td>“183”</td>
<td>“6.633550”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“784”</td>
<td>“HTTP/1.1 200 OK  (text/html)”</td>
</tr>
<tr>
<td>“237”</td>
<td>“8.389410”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“667”</td>
<td>“GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1 “</td>
</tr>
<tr>
<td>“268”</td>
<td>“8.655003”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“293”</td>
<td>“HTTP/1.1 304 Not Modified “</td>
</tr>
</tbody>
</table>
<p>Detail of packets:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Frame 142: 555 bytes on wire (4440 bits), 555 bytes captured (4440 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 1053, Dst Port: 80, Seq: 1, Ack: 1, Len: 501</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]</span><br><span class="line">    [HTTP request 1/2]</span><br><span class="line">    [Response in frame: 183]</span><br><span class="line">    [Next request in frame: 237]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Frame 183: 784 bytes on wire (6272 bits), 784 bytes captured (6272 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3</span><br><span class="line">Transmission Control Protocol, Src Port: 80, Dst Port: 1053, Seq: 1, Ack: 502, Len: 730</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    HTTP/1.1 200 OK\r\n</span><br><span class="line">    Date: Sun, 05 Sep 2021 12:49:23 GMT\r\n</span><br><span class="line">    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n</span><br><span class="line">    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n</span><br><span class="line">    ETag: &quot;173-5cb393aaefbf1&quot;\r\n</span><br><span class="line">    Accept-Ranges: bytes\r\n</span><br><span class="line">    Content-Length: 371\r\n</span><br><span class="line">    Keep-Alive: timeout=5, max=100\r\n</span><br><span class="line">    Connection: Keep-Alive\r\n</span><br><span class="line">    Content-Type: text/html; charset=UTF-8\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [HTTP response 1/2]</span><br><span class="line">    [Time since request: 0.264764000 seconds]</span><br><span class="line">    [Request in frame: 142]</span><br><span class="line">    [Next request in frame: 237]</span><br><span class="line">    [Next response in frame: 268]</span><br><span class="line">    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]</span><br><span class="line">    File Data: 371 bytes</span><br><span class="line">Line-based text data: text/html (10 lines)</span><br><span class="line">    \n</span><br><span class="line">    &lt;html&gt;\n</span><br><span class="line">    \n</span><br><span class="line">    Congratulations again!  Now you&apos;ve downloaded the file lab2-2.html. &lt;br&gt;\n</span><br><span class="line">    This file&apos;s last modification date will not change.  &lt;p&gt;\n</span><br><span class="line">    Thus  if you download this multiple times on your browser, a complete copy &lt;br&gt;\n</span><br><span class="line">    will only be sent once by the server due to the inclusion of the IN-MODIFIED-SINCE&lt;br&gt;\n</span><br><span class="line">    field in your browser&apos;s HTTP GET request to the server.\n</span><br><span class="line">    \n</span><br><span class="line">    &lt;/html&gt;\n</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Frame 237: 667 bytes on wire (5336 bits), 667 bytes captured (5336 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 1053, Dst Port: 80, Seq: 502, Ack: 731, Len: 613</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Cache-Control: max-age=0\r\n</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    If-None-Match: &quot;173-5cb393aaefbf1&quot;\r\n</span><br><span class="line">    If-Modified-Since: Sun, 05 Sep 2021 05:59:01 GMT\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]</span><br><span class="line">    [HTTP request 2/2]</span><br><span class="line">    [Prev request in frame: 142]</span><br><span class="line">    [Response in frame: 268]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Frame 268: 293 bytes on wire (2344 bits), 293 bytes captured (2344 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3</span><br><span class="line">Transmission Control Protocol, Src Port: 80, Dst Port: 1053, Seq: 731, Ack: 1115, Len: 239</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    HTTP/1.1 304 Not Modified\r\n</span><br><span class="line">    Date: Sun, 05 Sep 2021 12:49:25 GMT\r\n</span><br><span class="line">    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n</span><br><span class="line">    Connection: Keep-Alive\r\n</span><br><span class="line">    Keep-Alive: timeout=5, max=99\r\n</span><br><span class="line">    ETag: &quot;173-5cb393aaefbf1&quot;\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [HTTP response 2/2]</span><br><span class="line">    [Time since request: 0.265593000 seconds]</span><br><span class="line">    [Prev request in frame: 142]</span><br><span class="line">    [Prev response in frame: 183]</span><br><span class="line">    [Request in frame: 237]</span><br><span class="line">    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol start="8">
<li><p>Inspect the contents of the first HTTP GET request from your browser to the server.  Do you see an “IF-MODIFIED-SINCE” line in the HTTP GET?<br>No.</p>
</li>
<li><p>Inspect the contents of the server response. Did the server explicitly return the contents of the file?   How can you tell?<br>Yes, in the File Data field of the response packet.</p>
</li>
<li><p>Now inspect the contents of the second HTTP GET request from your browser to the server.  Do you see an “IF-MODIFIED-SINCE:” line in the HTTP GET ? If so, what information follows the “IF-MODIFIED-SINCE:” header?<br>Yes,  “If-Modified-Since: Sun, 05 Sep 2021 05:59:01 GMT\r\n”.</p>
</li>
<li><p>What is the HTTP status code and phrase returned from the server in response to this second HTTP GET?  Did the server explicitly return the contents of the file?   Explain.<br>Status code is 304(Not Modified), server didn’t return the contents of the file explicitly,  because the browser keep a copy of this file last modified at  “Sun, 05 Sep 2021 05:59:01 GMT”, and put this timestamp in “IF-MODIFIED-SINCE:” header field to inform the server no need to return the file didn’t modified after the timestamp.</p>
</li>
</ol>
<h3 id="Retrieving-Long-Documents"><a href="#Retrieving-Long-Documents" class="headerlink" title="Retrieving Long Documents"></a>Retrieving Long Documents</h3><p>Operations:</p>
<ul>
<li>Enter the following URL into your browser<br><a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html</a><br>Your browser should display the rather lengthy US Bill of Rights.</li>
</ul>
<p>Packets Captured:</p>
<table>
<thead>
<tr>
<th>“No.”</th>
<th>“Time”</th>
<th>“Source”</th>
<th>“Destination”</th>
<th>“Protocol”</th>
<th>“Length”</th>
<th>“Info”</th>
</tr>
</thead>
<tbody>
<tr>
<td>“146”</td>
<td>“4.150099”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“555”</td>
<td>“GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1 “</td>
</tr>
<tr>
<td>“176”</td>
<td>“4.411527”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“679”</td>
<td>“HTTP/1.1 200 OK  (text/html)”</td>
</tr>
</tbody>
</table>
<p>Packets Details:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Frame 146: 555 bytes on wire (4440 bits), 555 bytes captured (4440 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 1028, Dst Port: 80, Seq: 1, Ack: 1, Len: 501</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1\r\n</span><br><span class="line">        [Expert Info (Chat/Sequence): GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1\r\n]</span><br><span class="line">        Request Method: GET</span><br><span class="line">        Request URI: /wireshark-labs/HTTP-wireshark-file3.html</span><br><span class="line">        Request Version: HTTP/1.1</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]</span><br><span class="line">    [HTTP request 1/1]</span><br><span class="line">    [Response in frame: 176]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Frame 176: 679 bytes on wire (5432 bits), 679 bytes captured (5432 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">    Destination: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">    Source: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">    Type: IPv4 (0x0800)</span><br><span class="line">Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.3</span><br><span class="line">Transmission Control Protocol, Src Port: 80, Dst Port: 1028, Seq: 4237, Ack: 502, Len: 625</span><br><span class="line">[4 Reassembled TCP Segments (4861 bytes): #172(1412), #173(1412), #175(1412), #176(625)]</span><br><span class="line">    [Frame: 172, payload: 0-1411 (1412 bytes)]</span><br><span class="line">    [Frame: 173, payload: 1412-2823 (1412 bytes)]</span><br><span class="line">    [Frame: 175, payload: 2824-4235 (1412 bytes)]</span><br><span class="line">    [Frame: 176, payload: 4236-4860 (625 bytes)]</span><br><span class="line">    [Segment count: 4]</span><br><span class="line">    [Reassembled TCP length: 4861]</span><br><span class="line">    [Reassembled TCP Data: 485454502f312e3120323030204f4b0d0a446174653a2053756e2c203035205365702032…]</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    HTTP/1.1 200 OK\r\n</span><br><span class="line">        [Expert Info (Chat/Sequence): HTTP/1.1 200 OK\r\n]</span><br><span class="line">        Response Version: HTTP/1.1</span><br><span class="line">        Status Code: 200</span><br><span class="line">        [Status Code Description: OK]</span><br><span class="line">        Response Phrase: OK</span><br><span class="line">    Date: Sun, 05 Sep 2021 13:12:00 GMT\r\n</span><br><span class="line">    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n</span><br><span class="line">    Last-Modified: Sun, 05 Sep 2021 05:59:01 GMT\r\n</span><br><span class="line">    ETag: &quot;1194-5cb393aaeb1b8&quot;\r\n</span><br><span class="line">    Accept-Ranges: bytes\r\n</span><br><span class="line">    Content-Length: 4500\r\n</span><br><span class="line">    Keep-Alive: timeout=5, max=100\r\n</span><br><span class="line">    Connection: Keep-Alive\r\n</span><br><span class="line">    Content-Type: text/html; charset=UTF-8\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [HTTP response 1/1]</span><br><span class="line">    [Time since request: 0.261428000 seconds]</span><br><span class="line">    [Request in frame: 146]</span><br><span class="line">    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]</span><br><span class="line">    File Data: 4500 bytes</span><br><span class="line">Line-based text data: text/html (98 lines)</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol start="12">
<li><p>How many HTTP GET request messages did your browser send?  Which packet number in the trace contains the GET message for the Bill or Rights?<br>Only one, packet 146.</p>
</li>
<li><p>Which packet number in the trace contains the status code and phrase associated with the response to the HTTP GET request?<br>Packet 176.</p>
</li>
<li><p>What is the status code and phrase in the response?<br>200(OK).</p>
</li>
<li><p>How many data-containing TCP segments were needed to carry the single HTTP response and the text of the Bill of Rights?<br>4.</p>
</li>
</ol>
<h3 id="HTML-Documents-with-Embedded-Objects"><a href="#HTML-Documents-with-Embedded-Objects" class="headerlink" title="HTML Documents with Embedded Objects"></a>HTML Documents with Embedded Objects</h3><p>Operations:</p>
<ul>
<li>Enter the following URL into your browser<br><a href="http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html</a><br>Your browser should display a short HTML file with two images. These two images are referenced in the base HTML file.  That is, the images themselves are not contained in the HTML; instead the URLs for the images are contained in the downloaded HTML file. As discussed in the textbook, your browser will have to retrieve these logos from the indicated web sites.   Our publisher’s logo is retrieved from the gaia.cs.umass.edu web site.   The image of our 8th edition cover (one of our favorite covers) is stored at a server in France. </li>
</ul>
<p>Packets Captured:</p>
<table>
<thead>
<tr>
<th>“No.”</th>
<th>“Time”</th>
<th>“Source”</th>
<th>“Destination”</th>
<th>“Protocol”</th>
<th>“Length”</th>
<th>“Info”</th>
</tr>
</thead>
<tbody>
<tr>
<td>“28”</td>
<td>“2.033457”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“581”</td>
<td>“GET /wireshark-labs/HTTP-wireshark-file4.html HTTP/1.1 “</td>
</tr>
<tr>
<td>“41”</td>
<td>“2.304704”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“1355”</td>
<td>“HTTP/1.1 200 OK  (text/html)”</td>
</tr>
<tr>
<td>“42”</td>
<td>“2.338977”</td>
<td>“192.168.1.3”</td>
<td>“128.119.245.12”</td>
<td>“HTTP”</td>
<td>“501”</td>
<td>“GET /pearson.png HTTP/1.1 “</td>
</tr>
<tr>
<td>“47”</td>
<td>“2.530706”</td>
<td>“192.168.1.3”</td>
<td>“178.79.137.164”</td>
<td>“HTTP”</td>
<td>“468”</td>
<td>“GET /8E_cover_small.jpg HTTP/1.1 “</td>
</tr>
<tr>
<td>“55”</td>
<td>“2.609925”</td>
<td>“128.119.245.12”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“841”</td>
<td>“HTTP/1.1 200 OK  (PNG)”</td>
</tr>
<tr>
<td>“58”</td>
<td>“2.695694”</td>
<td>“178.79.137.164”</td>
<td>“192.168.1.3”</td>
<td>“HTTP”</td>
<td>“225”</td>
<td>“HTTP/1.1 301 Moved Permanently “</td>
</tr>
</tbody>
</table>
<p>Packets Details:<br>…</p>
<p>Q&amp;As:</p>
<ol start="16">
<li><p>How many HTTP GET request messages did your browser send?  To which Internet addresses were these GET requests sent?<br>Totally 3 GET requests, 2 to 128.119.245.12 to get html file and pearson.png, 1 to 178.79.137.164 for the 8E_cover_small.jpg.</p>
</li>
<li><p>Can you tell whether your browser downloaded the two images serially, or whether they were downloaded from the two web sites in parallel?  Explain.<br>In parallel.</p>
</li>
</ol>
<pre class="mermaid" style="text-align: center;">
            sequenceDiagram
            participant Browser
participant Server
Browser ->> Server: GET /pearson.png time:2.338977
Browser -->> Server: GET /8E_cover_small.jpg time:2.530706
Server ->> Browser: pearson.png time:2.609925
Server -->>Browser: 8E_cover_small.jpg time:2.695694
          </pre>
<h3 id="HTTP-Authentication"><a href="#HTTP-Authentication" class="headerlink" title="HTTP Authentication"></a>HTTP Authentication</h3><p>Operations:</p>
<ul>
<li>Enter the following URL into your browser<br><a href="http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html</a><br>Type the requested user name and password into the pop up box.  The username is “wireshark-students” (without the quotes), and the password is “network” (again, without the quotes).</li>
</ul>
<p>Packets Captured:</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>Time</th>
<th>Source</th>
<th>Destination</th>
<th>Protocol</th>
<th>Length</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>125</td>
<td>5.558621</td>
<td>192.168.1.3</td>
<td>128.119.245.12</td>
<td>HTTP</td>
<td>597</td>
<td>GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1</td>
</tr>
<tr>
<td>140</td>
<td>5.823233</td>
<td>128.119.245.12</td>
<td>192.168.1.3</td>
<td>HTTP</td>
<td>771</td>
<td>HTTP/1.1 401 Unauthorized  (text/html)</td>
</tr>
<tr>
<td>726</td>
<td>26.553076</td>
<td>192.168.1.3</td>
<td>128.119.245.12</td>
<td>HTTP</td>
<td>656</td>
<td>GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1</td>
</tr>
<tr>
<td>737</td>
<td>26.823450</td>
<td>128.119.245.12</td>
<td>192.168.1.3</td>
<td>HTTP</td>
<td>544</td>
<td>HTTP/1.1 200 OK  (text/html)</td>
</tr>
</tbody>
</table>
<p>Packets Details:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Frame 125: 597 bytes on wire (4776 bits), 597 bytes captured (4776 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 28007, Dst Port: 80, Seq: 1, Ack: 1, Len: 543</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n</span><br><span class="line">        [Expert Info (Chat/Sequence): GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n]</span><br><span class="line">        Request Method: GET</span><br><span class="line">        Request URI: /wireshark-labs/protected_pages/HTTP-wireshark-file5.html</span><br><span class="line">        Request Version: HTTP/1.1</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Cache-Control: max-age=0\r\n</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html]</span><br><span class="line">    [HTTP request 1/1]</span><br><span class="line">    [Response in frame: 140]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Frame 726: 656 bytes on wire (5248 bits), 656 bytes captured (5248 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.1.3, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 1028, Dst Port: 80, Seq: 1, Ack: 1, Len: 602</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n</span><br><span class="line">        [Expert Info (Chat/Sequence): GET /wireshark-labs/protected_pages/HTTP-wireshark-file5.html HTTP/1.1\r\n]</span><br><span class="line">        Request Method: GET</span><br><span class="line">        Request URI: /wireshark-labs/protected_pages/HTTP-wireshark-file5.html</span><br><span class="line">        Request Version: HTTP/1.1</span><br><span class="line">    Host: gaia.cs.umass.edu\r\n</span><br><span class="line">    Connection: keep-alive\r\n</span><br><span class="line">    Cache-Control: max-age=0\r\n</span><br><span class="line">    Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=\r\n</span><br><span class="line">        Credentials: wireshark-students:network</span><br><span class="line">    Upgrade-Insecure-Requests: 1\r\n</span><br><span class="line">    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.38\r\n</span><br><span class="line">    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\n</span><br><span class="line">    Accept-Encoding: gzip, deflate\r\n</span><br><span class="line">    Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wireshark-file5.html]</span><br><span class="line">    [HTTP request 1/1]</span><br><span class="line">    [Response in frame: 737]</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol start="18">
<li>What is the server’s response (status code and phrase) in response to the initial HTTP GET message from your browser?</li>
</ol>
<p>401 Unauthorized.</p>
<ol start="19">
<li>When your browser’s sends the HTTP GET message for the second time, what new field is included in the HTTP GET message?<br>Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=\r\n</li>
</ol>
<h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><h3 id="Trace-DNS-from-web-browser"><a href="#Trace-DNS-from-web-browser" class="headerlink" title="Trace DNS from web browser"></a>Trace DNS from web browser</h3><p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Open the following URL into your browser<br><a href="http://gaia.cs.umass.edu/kurose_ross/index.php" target="_blank" rel="noopener">http://gaia.cs.umass.edu/kurose_ross/index.php</a></li>
</ul>
<p>Captured packets:</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>Time</th>
<th>Source</th>
<th>Destination</th>
<th>Protocol</th>
<th>Length</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td>4.898665</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>fe80::1</td>
<td>DNS</td>
<td>97</td>
<td>Standard query 0xcba9 A gaia.cs.umass.edu</td>
</tr>
<tr>
<td>29</td>
<td>4.908337</td>
<td>fe80::1</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>DNS</td>
<td>113</td>
<td>Standard query response 0xcba9 A gaia.cs.umass.edu A 128.119.245.12</td>
</tr>
</tbody>
</table>
<p>Detail of packets:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Frame 20: 97 bytes on wire (776 bits), 97 bytes captured (776 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1</span><br><span class="line">User Datagram Protocol, Src Port: 61277, Dst Port: 53</span><br><span class="line">Domain Name System (query)</span><br><span class="line">    Transaction ID: 0xcba9</span><br><span class="line">    Flags: 0x0100 Standard query</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 0</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        gaia.cs.umass.edu: type A, class IN</span><br><span class="line">            Name: gaia.cs.umass.edu</span><br><span class="line">            [Name Length: 17]</span><br><span class="line">            [Label Count: 4]</span><br><span class="line">            Type: A (Host Address) (1)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    [Response In: 29]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Frame 29: 113 bytes on wire (904 bits), 113 bytes captured (904 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877</span><br><span class="line">User Datagram Protocol, Src Port: 53, Dst Port: 61277</span><br><span class="line">Domain Name System (response)</span><br><span class="line">    Transaction ID: 0xcba9</span><br><span class="line">    Flags: 0x8180 Standard query response, No error</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 1</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        gaia.cs.umass.edu: type A, class IN</span><br><span class="line">            Name: gaia.cs.umass.edu</span><br><span class="line">            [Name Length: 17]</span><br><span class="line">            [Label Count: 4]</span><br><span class="line">            Type: A (Host Address) (1)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    Answers</span><br><span class="line">        gaia.cs.umass.edu: type A, class IN, addr 128.119.245.12</span><br><span class="line">    [Request In: 20]</span><br><span class="line">    [Time: 0.009672000 seconds]</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol>
<li>Locate the first DNS query message resolving the name gaia.cs.umass.edu. What is the packet number  in the trace for the DNS query message?  Is this query message sent over UDP or TCP?</li>
</ol>
<p>20, UDP.</p>
<ol start="2">
<li>Now locate the corresponding DNS response to the initial DNS query. What is the packet number in the trace for the DNS response message?  Is this response message received via UDP or TCP?   </li>
</ol>
<p>29, UDP.</p>
<ol start="3">
<li>What is the destination port for the DNS query message? What is the source port of the DNS response message?</li>
</ol>
<p>53 .</p>
<ol start="4">
<li>To what IP address is the DNS query message sent? </li>
</ol>
<p>fe80::1.</p>
<ol start="5">
<li>Examine the DNS query message. How many “questions” does this DNS message contain? How many “answers” answers does it contain?</li>
</ol>
<p>Questions: 1<br>Answer RRs: 0</p>
<ol start="6">
<li>Examine the DNS response message to the initial query message. How many “questions” does this DNS message contain? How many “answers” answers does it contain?</li>
</ol>
<p>Questions: 1<br>Answer RRs: 1</p>
<h3 id="Trace-DNS-from-nslookup"><a href="#Trace-DNS-from-nslookup" class="headerlink" title="Trace DNS from nslookup"></a>Trace DNS from nslookup</h3><p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Do an nslookup on <a href="http://www.cs.umass.edu" target="_blank" rel="noopener">www.cs.umass.edu</a></li>
</ul>
<p>Captured packets:</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>Time</th>
<th>Source</th>
<th>Destination</th>
<th>Protocol</th>
<th>Length</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>56</td>
<td>10.981691</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>fe80::1</td>
<td>DNS</td>
<td>96</td>
<td>Standard query 0x7a54 A <a href="http://www.cs.umass.edu" target="_blank" rel="noopener">www.cs.umass.edu</a></td>
</tr>
<tr>
<td>57</td>
<td>10.981916</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>fe80::1</td>
<td>DNS</td>
<td>96</td>
<td>Standard query 0xd102 AAAA <a href="http://www.cs.umass.edu" target="_blank" rel="noopener">www.cs.umass.edu</a></td>
</tr>
<tr>
<td>58</td>
<td>11.232144</td>
<td>fe80::1</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>DNS</td>
<td>96</td>
<td>Standard query response 0xd102 AAAA <a href="http://www.cs.umass.edu" target="_blank" rel="noopener">www.cs.umass.edu</a></td>
</tr>
<tr>
<td>59</td>
<td>11.255062</td>
<td>fe80::1</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>DNS</td>
<td>112</td>
<td>Standard query response 0x7a54 A <a href="http://www.cs.umass.edu" target="_blank" rel="noopener">www.cs.umass.edu</a> A 128.119.240.84</td>
</tr>
</tbody>
</table>
<p>Detail of packets:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Frame 56: 96 bytes on wire (768 bits), 96 bytes captured (768 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1</span><br><span class="line">User Datagram Protocol, Src Port: 51185, Dst Port: 53</span><br><span class="line">Domain Name System (query)</span><br><span class="line">    Transaction ID: 0x7a54</span><br><span class="line">    Flags: 0x0100 Standard query</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 0</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        www.cs.umass.edu: type A, class IN</span><br><span class="line">            Name: www.cs.umass.edu</span><br><span class="line">            [Name Length: 16]</span><br><span class="line">            [Label Count: 4]</span><br><span class="line">            Type: A (Host Address) (1)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    [Response In: 59]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Frame 59: 112 bytes on wire (896 bits), 112 bytes captured (896 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877</span><br><span class="line">User Datagram Protocol, Src Port: 53, Dst Port: 51185</span><br><span class="line">Domain Name System (response)</span><br><span class="line">    Transaction ID: 0x7a54</span><br><span class="line">    Flags: 0x8180 Standard query response, No error</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 1</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        www.cs.umass.edu: type A, class IN</span><br><span class="line">            Name: www.cs.umass.edu</span><br><span class="line">            [Name Length: 16]</span><br><span class="line">            [Label Count: 4]</span><br><span class="line">            Type: A (Host Address) (1)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    Answers</span><br><span class="line">        www.cs.umass.edu: type A, class IN, addr 128.119.240.84</span><br><span class="line">    [Request In: 56]</span><br><span class="line">    [Time: 0.273371000 seconds]</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol start="7">
<li>What is the destination port for the DNS query message? What is the source port of the DNS response message?</li>
</ol>
<p>53</p>
<ol start="8">
<li>To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?</li>
</ol>
<p>fe80::1, yes.</p>
<ol start="9">
<li>Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?</li>
</ol>
<p>No.</p>
<ol start="10">
<li>Examine the DNS response message to the query message. How many “questions” does this DNS response message contain? How many “answers”?</li>
</ol>
<p>Questions: 1<br>Answer RRs: 1</p>
<h3 id="Trace-DNS-from-nslookup-with-NS-type-record"><a href="#Trace-DNS-from-nslookup-with-NS-type-record" class="headerlink" title="Trace DNS from nslookup with NS type record"></a>Trace DNS from nslookup with NS type record</h3><p>Operations:</p>
<ul>
<li>Clear DNS cache by ‘ipconfig’ command</li>
<li>Do an nslookup -type=NS umass.edu</li>
</ul>
<p>Captured packets:</p>
<table>
<thead>
<tr>
<th>No.</th>
<th>Time</th>
<th>Source</th>
<th>Destination</th>
<th>Protocol</th>
<th>Length</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>37</td>
<td>1.731935</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>fe80::1</td>
<td>DNS</td>
<td>89</td>
<td>Standard query 0x0002 NS umass.edu</td>
</tr>
<tr>
<td>38</td>
<td>1.738860</td>
<td>fe80::1</td>
<td>fe80::604d:b1a2:55ef:5877</td>
<td>DNS</td>
<td>143</td>
<td>Standard query response 0x0002 NS umass.edu NS ns2.umass.edu NS ns1.umass.edu NS ns3.umass.edu</td>
</tr>
</tbody>
</table>
<p>Detail of packets:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Frame 37: 89 bytes on wire (712 bits), 89 bytes captured (712 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Micro-St_06:62:ec (00:d8:61:06:62:ec), Dst: Fiberhom_35:92:b1 (74:5d:68:35:92:b1)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::604d:b1a2:55ef:5877, Dst: fe80::1</span><br><span class="line">User Datagram Protocol, Src Port: 56756, Dst Port: 53</span><br><span class="line">Domain Name System (query)</span><br><span class="line">    Transaction ID: 0x0002</span><br><span class="line">    Flags: 0x0100 Standard query</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 0</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        umass.edu: type NS, class IN</span><br><span class="line">            Name: umass.edu</span><br><span class="line">            [Name Length: 9]</span><br><span class="line">            [Label Count: 2]</span><br><span class="line">            Type: NS (authoritative Name Server) (2)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    [Response In: 38]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Frame 38: 143 bytes on wire (1144 bits), 143 bytes captured (1144 bits) on interface \Device\NPF_&#123;0A0B317B-E1D8-4D27-9D8A-9E3EC63057D4&#125;, id 0</span><br><span class="line">Ethernet II, Src: Fiberhom_35:92:b1 (74:5d:68:35:92:b1), Dst: Micro-St_06:62:ec (00:d8:61:06:62:ec)</span><br><span class="line">Internet Protocol Version 6, Src: fe80::1, Dst: fe80::604d:b1a2:55ef:5877</span><br><span class="line">User Datagram Protocol, Src Port: 53, Dst Port: 56756</span><br><span class="line">Domain Name System (response)</span><br><span class="line">    Transaction ID: 0x0002</span><br><span class="line">    Flags: 0x8180 Standard query response, No error</span><br><span class="line">    Questions: 1</span><br><span class="line">    Answer RRs: 3</span><br><span class="line">    Authority RRs: 0</span><br><span class="line">    Additional RRs: 0</span><br><span class="line">    Queries</span><br><span class="line">        umass.edu: type NS, class IN</span><br><span class="line">            Name: umass.edu</span><br><span class="line">            [Name Length: 9]</span><br><span class="line">            [Label Count: 2]</span><br><span class="line">            Type: NS (authoritative Name Server) (2)</span><br><span class="line">            Class: IN (0x0001)</span><br><span class="line">    Answers</span><br><span class="line">        umass.edu: type NS, class IN, ns ns2.umass.edu</span><br><span class="line">        umass.edu: type NS, class IN, ns ns1.umass.edu</span><br><span class="line">        umass.edu: type NS, class IN, ns ns3.umass.edu</span><br><span class="line">    [Request In: 37]</span><br><span class="line">    [Time: 0.006925000 seconds]</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol start="11">
<li>To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?</li>
</ol>
<p>fe80::1, yes.</p>
<ol start="12">
<li>Examine the DNS query message. How many questions does the query have? Does the query message contain any “answers”?</li>
</ol>
<p>No.</p>
<ol start="13">
<li>Examine the DNS response message.  How many answers does the response have?  What information is contained in the answers? </li>
</ol>
<p>3 answers, name servers of the name in query.</p>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><h3 id="Upload-a-150-KB-file"><a href="#Upload-a-150-KB-file" class="headerlink" title="Upload a 150+ KB file"></a>Upload a 150+ KB file</h3><p>Captured data:</p>
<p>Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet file tcp-wireshark-trace1-1 in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip</a>  </p>
<table>
<thead>
<tr>
<th>No.</th>
<th>Time</th>
<th>Source</th>
<th>Destination</th>
<th>Protocol</th>
<th>Length</th>
<th>Info</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.000000</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>78</td>
<td>55639  &gt;  80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=64 TSval=725607509 TSecr=0 SACK_PERM=1</td>
</tr>
<tr>
<td>2</td>
<td>0.022414</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>74</td>
<td>80  &gt;  55639 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1460 SACK_PERM=1 TSval=3913851370 TSecr=725607509 WS=128</td>
</tr>
<tr>
<td>3</td>
<td>0.022505</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>66</td>
<td>55639  &gt;  80 [ACK] Seq=1 Ack=1 Win=131712 Len=0 TSval=725607531 TSecr=3913851370</td>
</tr>
<tr>
<td>4</td>
<td>0.024047</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=1 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>5</td>
<td>0.024048</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=1449 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>6</td>
<td>0.024049</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=2897 Ack=1 Win=131712 Len=1448 TSval=725607532 TSecr=3913851370 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>7</td>
<td>0.052671</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=1449 Win=31872 Len=0 TSval=3913851399 TSecr=725607532</td>
</tr>
<tr>
<td>8</td>
<td>0.052676</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=2897 Win=34816 Len=0 TSval=3913851400 TSecr=725607532</td>
</tr>
<tr>
<td>9</td>
<td>0.052774</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=4345 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851399 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>10</td>
<td>0.052775</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=5793 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851399 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>11</td>
<td>0.052854</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=7241 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>12</td>
<td>0.052855</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=8689 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>13</td>
<td>0.053626</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=4345 Win=37760 Len=0 TSval=3913851400 TSecr=725607532</td>
</tr>
<tr>
<td>14</td>
<td>0.053710</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=10137 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>15</td>
<td>0.053711</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=11585 Ack=1 Win=131712 Len=1448 TSval=725607560 TSecr=3913851400 [TCP segment of a reassembled PDU]</td>
</tr>
<tr>
<td>16</td>
<td>0.080768</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=5793 Win=40576 Len=0 TSval=3913851421 TSecr=725607560</td>
</tr>
<tr>
<td>17</td>
<td>0.080771</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=7241 Win=43520 Len=0 TSval=3913851422 TSecr=725607560</td>
</tr>
<tr>
<td>18</td>
<td>0.080772</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=8689 Win=46336 Len=0 TSval=3913851422 TSecr=725607560</td>
</tr>
<tr>
<td>19</td>
<td>0.080772</td>
<td>128.119.245.12</td>
<td>192.168.86.68</td>
<td>TCP</td>
<td>66</td>
<td>80  &gt;  55639 [ACK] Seq=1 Ack=10137 Win=49280 Len=0 TSval=3913851422 TSecr=725607560</td>
</tr>
<tr>
<td>20</td>
<td>0.080845</td>
<td>192.168.86.68</td>
<td>128.119.245.12</td>
<td>TCP</td>
<td>1514</td>
<td>55639  &gt;  80 [ACK] Seq=13033 Ack=1 Win=131712 Len=1448 TSval=725607588 TSecr=3913851421 [TCP segment of a reassembled PDU]</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Frame 1: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en0, id 0</span><br><span class="line">Ethernet II, Src: Apple_98:d9:27 (78:4f:43:98:d9:27), Dst: Google_89:0e:c8 (3c:28:6d:89:0e:c8)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.86.68, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 0, Len: 0</span><br><span class="line">    Source Port: 55639</span><br><span class="line">    Destination Port: 80</span><br><span class="line">    [Stream index: 0]</span><br><span class="line">    [TCP Segment Len: 0]</span><br><span class="line">    Sequence Number: 0    (relative sequence number)</span><br><span class="line">    Sequence Number (raw): 4236649187</span><br><span class="line">    [Next Sequence Number: 1    (relative sequence number)]</span><br><span class="line">    Acknowledgment Number: 0</span><br><span class="line">    Acknowledgment number (raw): 0</span><br><span class="line">    1011 .... = Header Length: 44 bytes (11)</span><br><span class="line">    Flags: 0x002 (SYN)</span><br><span class="line">    Window: 65535</span><br><span class="line">    [Calculated window size: 65535]</span><br><span class="line">    Checksum: 0xa1e4 [unverified]</span><br><span class="line">    [Checksum Status: Unverified]</span><br><span class="line">    Urgent Pointer: 0</span><br><span class="line">    Options: (24 bytes), Maximum segment size, No-Operation (NOP), Window scale, No-Operation (NOP), No-Operation (NOP), Timestamps, SACK permitted, End of Option List (EOL)</span><br><span class="line">        TCP Option - Maximum segment size: 1460 bytes</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - Window scale: 6 (multiply by 64)</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - Timestamps: TSval 725607509, TSecr 0</span><br><span class="line">        TCP Option - SACK permitted</span><br><span class="line">        TCP Option - End of Option List (EOL)</span><br><span class="line">    [Timestamps]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Frame 2: 74 bytes on wire (592 bits), 74 bytes captured (592 bits) on interface en0, id 0</span><br><span class="line">Ethernet II, Src: Google_89:0e:c8 (3c:28:6d:89:0e:c8), Dst: Apple_98:d9:27 (78:4f:43:98:d9:27)</span><br><span class="line">Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.86.68</span><br><span class="line">Transmission Control Protocol, Src Port: 80, Dst Port: 55639, Seq: 0, Ack: 1, Len: 0</span><br><span class="line">    Source Port: 80</span><br><span class="line">    Destination Port: 55639</span><br><span class="line">    [Stream index: 0]</span><br><span class="line">    [TCP Segment Len: 0]</span><br><span class="line">    Sequence Number: 0    (relative sequence number)</span><br><span class="line">    Sequence Number (raw): 1068969752</span><br><span class="line">    [Next Sequence Number: 1    (relative sequence number)]</span><br><span class="line">    Acknowledgment Number: 1    (relative ack number)</span><br><span class="line">    Acknowledgment number (raw): 4236649188</span><br><span class="line">    1010 .... = Header Length: 40 bytes (10)</span><br><span class="line">    Flags: 0x012 (SYN, ACK)</span><br><span class="line">    Window: 28960</span><br><span class="line">    [Calculated window size: 28960]</span><br><span class="line">    Checksum: 0x47b4 [unverified]</span><br><span class="line">    [Checksum Status: Unverified]</span><br><span class="line">    Urgent Pointer: 0</span><br><span class="line">    Options: (20 bytes), Maximum segment size, SACK permitted, Timestamps, No-Operation (NOP), Window scale</span><br><span class="line">        TCP Option - Maximum segment size: 1460 bytes</span><br><span class="line">        TCP Option - SACK permitted</span><br><span class="line">        TCP Option - Timestamps: TSval 3913851370, TSecr 725607509</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - Window scale: 7 (multiply by 128)</span><br><span class="line">    [SEQ/ACK analysis]</span><br><span class="line">    [Timestamps]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Frame 4: 1514 bytes on wire (12112 bits), 1514 bytes captured (12112 bits) on interface en0, id 0</span><br><span class="line">Ethernet II, Src: Apple_98:d9:27 (78:4f:43:98:d9:27), Dst: Google_89:0e:c8 (3c:28:6d:89:0e:c8)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.86.68, Dst: 128.119.245.12</span><br><span class="line">Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 1, Ack: 1, Len: 1448</span><br><span class="line">    Source Port: 55639</span><br><span class="line">    Destination Port: 80</span><br><span class="line">    [Stream index: 0]</span><br><span class="line">    [TCP Segment Len: 1448]</span><br><span class="line">    Sequence Number: 1    (relative sequence number)</span><br><span class="line">    Sequence Number (raw): 4236649188</span><br><span class="line">    [Next Sequence Number: 1449    (relative sequence number)]</span><br><span class="line">    Acknowledgment Number: 1    (relative ack number)</span><br><span class="line">    Acknowledgment number (raw): 1068969753</span><br><span class="line">    1000 .... = Header Length: 32 bytes (8)</span><br><span class="line">    Flags: 0x010 (ACK)</span><br><span class="line">    Window: 2058</span><br><span class="line">    [Calculated window size: 131712]</span><br><span class="line">    [Window size scaling factor: 64]</span><br><span class="line">    Checksum: 0xbd21 [unverified]</span><br><span class="line">    [Checksum Status: Unverified]</span><br><span class="line">    Urgent Pointer: 0</span><br><span class="line">    Options: (12 bytes), No-Operation (NOP), No-Operation (NOP), Timestamps</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - No-Operation (NOP)</span><br><span class="line">        TCP Option - Timestamps: TSval 725607532, TSecr 3913851370</span><br><span class="line">    [SEQ/ACK analysis]</span><br><span class="line">    [Timestamps]</span><br><span class="line">    TCP payload (1448 bytes)</span><br><span class="line">    [Reassembled PDU in frame: 153]</span><br><span class="line">    TCP segment data (1448 bytes)</span><br></pre></td></tr></table></figure>
<p>Q&amp;As:</p>
<ol>
<li>What is the sequence number of the TCP SYN segment that is used to initiate the TCP connection between the client computer and gaia.cs.umass.edu? (Note: this is the “raw” sequence number carried in the TCP segment itself; it is NOT the packet # in the “No.” column in the Wireshark window.  Remember there is no such thing as a “packet number” in TCP or UDP; as you know, there are sequence numbers in TCP and that’s what we’re after here.  Also note that this is not the relative sequence number with respect to the starting sequence number of this TCP session.). What is it in this TCP segment that identifies the segment as a SYN segment? Will the TCP receiver in this session be able to use Selective Acknowledgments (allowing TCP to function a bit more like a “selective repeat” receiver, see section 3.4.5 in the text)?</li>
</ol>
<p>Sequence Number (raw): 4236649187. </p>
<p>The ‘Flags: 0x002 (SYN)’ identifies the segment as a SYN segment.</p>
<p>Yes, there is an option ‘SACK permitted’.</p>
<ol start="2">
<li>What is the sequence number of the SYNACK segment sent by gaia.cs.umass.edu to the client computer in reply to the SYN? What is it in the segment that identifies the segment as a SYNACK segment? What is the value of the Acknowledgement field in the SYNACK segment? How did gaia.cs.umass.edu determine that value? </li>
</ol>
<p>Sequence Number (raw): 1068969752</p>
<p>Flags: 0x012 (SYN, ACK) identifies the segment as a SYNACK segment.</p>
<p>Acknowledgment number (raw): 4236649188</p>
<p>Ack = Seq<sub>(peer)</sub> + 1.</p>
<ol start="3">
<li>What is the sequence number of the TCP segment containing the header of the HTTP POST command?  Note that in order to find the POST message header, you’ll need to dig into the packet content field at the bottom of the Wireshark window, looking for a segment with the ASCII text “POST” within its DATA field , .  How many bytes of data are contained in the payload (data) field of this TCP segment? Did all of the data in the transferred file alice.txt fit into this single segment?</li>
</ol>
<p>Sequence Number (raw): 4236649188. </p>
<p>TCP payload (1448 bytes).</p>
<p>No.</p>
<ol start="4">
<li>Consider the TCP segment containing the HTTP “POST” as the first segment in the data transfer part of the TCP connection.<br>•    At what time was the first segment (the one containing the HTTP POST) in the<br>data-transfer part of the TCP connection sent?  </li>
</ol>
<p>0.024047s.</p>
<p>•    At what time was the ACK for this first data-containing segment received?  </p>
<p>0.052671s.</p>
<p>•    What is the RTT for this first data-containing segment? </p>
<p>[The RTT to ACK the segment was: 0.028624000 seconds]</p>
<p>•    What is the RTT value the second data-carrying TCP segment and its ACK? </p>
<p>[The RTT to ACK the segment was: 0.028628000 seconds]</p>
<p>•    What is the EstimatedRTT value (see Section 3.5.3, in the text) after the ACK for the second data-carrying segment is received? Assume that in making this calculation after the received of the ACK for the second segment, that the initial value of EstimatedRTT is equal to the measured RTT for the first segment, and then is computed using the EstimatedRTT equation on page 242, and a value of $\alpha$ = 0.125.<br>Note: Wireshark has a nice feature that allows you to plot the RTT for each of the TCP segments sent.  Select a TCP segment in the “listing of captured packets” window that is being sent from the client to the gaia.cs.umass.edu server.  Then select: Statistics-&gt;TCP Stream Graph-&gt;Round Trip Time Graph.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># mesured RTT for these two packets.</span><br><span class="line">[The RTT to ACK the segment was: 0.028624000 seconds]</span><br><span class="line">[The RTT to ACK the segment was: 0.028628000 seconds]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EstimatedRTT = (1 – α) • EstimatedRTT + α • SampleRTT</span><br><span class="line"></span><br><span class="line">So EstimatedRTT is $0.875*0.028624000 + 0.125*0.028628000 = 0.02862449s$.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5.	What is the length (header plus payload) of each of the first four data-carrying TCP segments?</span><br></pre></td></tr></table></figure>
<p>Transmission Control Protocol, Src Port: 55639, Dst Port: 80, Seq: 1, Ack: 1, Len: 1448<br>    TCP segment data (1448 bytes)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1448 Bytes.</span><br><span class="line"></span><br><span class="line">6.	What is the minimum amount of available buffer space advertised to the client by gaia.cs.umass.edu among these first four data-carrying TCP segments ?  Does the lack of receiver buffer space ever throttle the sender for these first four data-carrying segments?</span><br></pre></td></tr></table></figure></p>
<p>[Calculated window size: 31872]<br>[Calculated window size: 34816]<br>[Calculated window size: 37760]<br>[Calculated window size: 40576]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">The lack of receiver buffer space **never** throttle the sender for these first four data-carrying segments</span><br><span class="line"></span><br><span class="line">7.	Are there any retransmitted segments in the trace file? What did you check for (in the trace) in order to answer this question?</span><br><span class="line"></span><br><span class="line"> In the TimeSequence-Graph (Stevens) of this trace (if it&apos;s a straight line, click the reset direction button), all sequence numbers are incresing monotonically.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8.	How much data does the receiver typically acknowledge in an ACK among the first ten data-carrying segments sent from the client to gaia.cs.umass.edu?  Can you identify cases where the receiver is ACKing every other received segment (see Table 3.2 in the text) among these first ten data-carrying segments?</span><br><span class="line"></span><br><span class="line">1448 bytes, No.8 packet Ack=2897, and No.7 Ack=1449, it is Acking 1448 bytes.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">9.	What is the throughput (bytes transferred per unit time) for the TCP connection?  Explain how you calculated this value.</span><br><span class="line"></span><br><span class="line">The last Ack is 153426, time is 0.191496s, and the first data carrying packet&apos;s time is 0.024047, so $bandwidth = 153426 byte / (0.191496s -  0.024047s) \approx 916255 byte/s$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">10.	Use the Time-Sequence-Graph(Stevens) plotting tool to view the sequence number versus time plot of segments being sent from the client to the gaia.cs.umass.edu server.  Consider the “fleets” of packets sent around t = 0.025, t = 0.053, t = 0.082 and t = 0.1. Comment on whether this looks as if TCP is in its slow start phase, congestion avoidance phase or some other phase. Figure 6 shows a slightly different view of this data.</span><br><span class="line"></span><br><span class="line">Yes, in $t=0.025$ about 4 packets received, $t=0.053$ about 6 packets received, $t=0.082$ about 12 packets received, $t=0.1$ about 24 packets received, It is &apos;slow start&apos; mechanism of TCP, the window size grows up exponentially.</span><br><span class="line"></span><br><span class="line">11.	These “fleets” of segments appear to have some periodicity. What can you say about the period?</span><br><span class="line"></span><br><span class="line">The period is close to the RTT, because the TCP need a RTT time at averange to calculate the new Esitimated RTT and decides how many packets will be sent.</span><br><span class="line"></span><br><span class="line">## UDP</span><br><span class="line"></span><br><span class="line">### Trigger UDP packets through nslookup</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Captured data:</span><br><span class="line"></span><br><span class="line">Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file dns-wireshark-trace1-1 in  http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1.	Select the first UDP segment in your trace. What is the packet number  of this segment in the trace file?  What type of application-layer payload or protocol message is being carried in this UDP segment?  Look at the details of this packet in Wireshark.  How many fields there are in the UDP header? (You shouldn’t look in the textbook! Answer these questions directly from what you observe in the packet trace.) What are the names of these fields?</span><br></pre></td></tr></table></figure></p>
<p>User Datagram Protocol, Src Port: 47931, Dst Port: 1900<br>    Source Port: 47931<br>    Destination Port: 1900<br>    Length: 283<br>    Checksum: 0xf7a8 [unverified]<br>    [Checksum Status: Unverified]<br>    [Stream index: 0]<br>    [Timestamps]<br>        [Time since first frame: 0.000000000 seconds]<br>        [Time since previous frame: 0.000000000 seconds]<br>    UDP payload (275 bytes)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">5th, SSDP(Simple Service Discovery Protocol), There are 4 fields in UDP Header: Source Port, Destination Port, Length, Checksum.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.	By consulting the displayed information in Wireshark’s packet content field for this packet (or by consulting the textbook), what is the length (in bytes) of each of the UDP header fields?</span><br><span class="line"></span><br><span class="line">Through observation, length of each field is 2 bytes.</span><br><span class="line"></span><br><span class="line">3.	The value in the Length field is the length of what? (You can consult the text for this answer). Verify your claim with your captured UDP packet. </span><br><span class="line"></span><br><span class="line">The value of the length field is 283, which is  (UDP payload (275 bytes) + Header length(8 bytes) ).</span><br><span class="line"></span><br><span class="line">4.	What is the maximum number of bytes that can be included in a UDP payload?  (Hint: the answer to this question can be determined by your answer to 2. above)</span><br><span class="line"></span><br><span class="line">The Maximum value of length field is 0xFFFF(65535 in decimal), so maximum bytes of payload is $65535 - 8 = 65527bytes$.</span><br><span class="line"></span><br><span class="line">5.	What is the largest possible source port number? (Hint: see the hint in 4.)</span><br><span class="line"></span><br><span class="line">It is 65535.</span><br><span class="line"></span><br><span class="line">6.	What is the protocol number for UDP? Give your answer in decimal notation. To answer this question, you’ll need to look into the Protocol field of the IP datagram containing this UDP segment (see Figure 4.13 in the text, and the discussion of IP header fields).</span><br></pre></td></tr></table></figure>
<p>Internet Protocol Version 4, Src: 10.0.0.254, Dst: 239.255.255.250<br>    0100 …. = Version: 4<br>    …. 0101 = Header Length: 20 bytes (5)<br>    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)<br>    Total Length: 303<br>    Identification: 0xa1c3 (41411)<br>    Flags: 0x40, Don’t fragment<br>    Fragment Offset: 0<br>    Time to Live: 4<br>    Protocol: UDP (17)<br>    Header Checksum: 0xd902 [validation disabled]<br>    [Header checksum status: Unverified]<br>    Source Address: 10.0.0.254<br>    Destination Address: 239.255.255.250</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">It is 17.</span><br><span class="line"></span><br><span class="line">7.	Examine the pair of UDP packets in which your host sends the first UDP packet and the second UDP packet is a reply to this first UDP packet. (Hint: for a second packet to be sent in response to a first packet, the sender of the first packet should be the destination of the second packet).  What is the packet number  of the first of these two UDP segments in the trace file?  What is the packet number  of the second of these two UDP segments in the trace file? Describe the relationship between the port numbers in the two packets.</span><br></pre></td></tr></table></figure>
<p>request:<br>User Datagram Protocol, Src Port: 58350, Dst Port: 53<br>    Source Port: 58350<br>    Destination Port: 53<br>    Length: 43<br>    Checksum: 0xc31d [unverified]<br>    [Checksum Status: Unverified]<br>    [Stream index: 1]<br>    [Timestamps]<br>        [Time since first frame: 0.000000000 seconds]<br>        [Time since previous frame: 0.000000000 seconds]<br>    UDP payload (35 bytes)</p>
<p>response:<br>User Datagram Protocol, Src Port: 53, Dst Port: 58350<br>    Source Port: 53<br>    Destination Port: 58350<br>    Length: 59<br>    Checksum: 0x4af2 [unverified]<br>    [Checksum Status: Unverified]<br>    [Stream index: 1]<br>    [Timestamps]<br>        [Time since first frame: 0.023908000 seconds]<br>        [Time since previous frame: 0.023908000 seconds]<br>    UDP payload (51 bytes)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">The destination port of the response packet is same as the request packet&apos;s source port, reverse is also true.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## IP</span><br><span class="line"></span><br><span class="line">### Capturing packets from an execution of traceroute</span><br><span class="line"></span><br><span class="line">Captured data:</span><br><span class="line"></span><br><span class="line">Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file ip-wireshark-trace1-1.pcapng in  http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip  </span><br><span class="line"></span><br><span class="line">#### Part 1: Basic IPv4</span><br><span class="line"></span><br><span class="line">1.	Select the first UDP segment sent by your computer via the traceroute command to gaia.cs.umass.edu. (Hint: this is 44th packet in the trace file in the ip-wireshark-trace1-1.pcapng file in footnote 2). Expand the Internet Protocol part of the packet in the packet details window.  What is the IP address of your computer?</span><br></pre></td></tr></table></figure>
<p>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12<br>    0100 …. = Version: 4<br>    …. 0101 = Header Length: 20 bytes (5)<br>    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)<br>    Total Length: 56<br>    Identification: 0xfda1 (64929)<br>    Flags: 0x00<br>    Fragment Offset: 0<br>    Time to Live: 1<br>    Protocol: UDP (17)<br>    Header Checksum: 0x2faa [validation disabled]<br>    [Header checksum status: Unverified]<br>    Source Address: 192.168.86.61<br>    Destination Address: 128.119.245.12</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">IP of local computer is 192.168.86.61 .</span><br><span class="line"></span><br><span class="line">2.	What is the value in the time-to-live (TTL) field in this IPv4 datagram’s header?</span><br><span class="line"></span><br><span class="line">1 .</span><br><span class="line"></span><br><span class="line">3.	What is the value in the upper layer protocol field in this IPv4 datagram’s header? [Note: the answers for Linux/MacOS differ from Windows here].</span><br><span class="line"></span><br><span class="line">Protocol: UDP (17).</span><br><span class="line"></span><br><span class="line">4.	How many bytes are in the IP header? </span><br><span class="line"></span><br><span class="line">.... 0101 = Header Length: 20 bytes (5).</span><br><span class="line"></span><br><span class="line">5.	How many bytes are in the payload of the IP datagram?  Explain how you determined the number of payload bytes.</span><br><span class="line"></span><br><span class="line">$Payload Length = Total Length - Header Length = 56 - 20 = 36 Bytes$</span><br><span class="line"></span><br><span class="line">6.	Has this IP datagram been fragmented?  Explain how you determined whether or not the datagram has been fragmented.</span><br><span class="line"></span><br><span class="line">No, if it is fragmented, the payload length of IP layer should be less than the Length of upper layer.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">7.	Which fields in the IP datagram always change from one datagram to the next within this series of UDP segments sent by your computer destined to 128.119.245.12, via traceroute?  Why?</span><br><span class="line"></span><br><span class="line">TTL and destination port, because traceroute set the TTL to n to trigger a ICMP response packet (ttl exceeded) on the $n_&#123;th&#125;$ hot of the route of the packet. destination port is used to track the coresponding response of each packet. </span><br><span class="line"></span><br><span class="line">8.	Which fields in this sequence of IP datagrams (containing UDP segments) stay constant? Why?</span><br><span class="line"></span><br><span class="line">The destination IP and the source port/IP, because the function of traceroute is to trace the route between the source IP and a specific destination IP.</span><br><span class="line"></span><br><span class="line">9.	Describe the pattern you see in the values in the Identification field of the IP datagrams being sent by your computer.</span><br><span class="line"></span><br><span class="line">Plus 1 after every packet sent.</span><br><span class="line"></span><br><span class="line">10.	What is the upper layer protocol specified in the IP datagrams returned from the routers? [Note: the answers for Linux/MacOS differ from Windows here].</span><br></pre></td></tr></table></figure>
<p>Internet Protocol Version 4, Src: 192.168.86.1, Dst: 192.168.86.61<br>    0100 …. = Version: 4<br>    …. 0101 = Header Length: 20 bytes (5)<br>    Differentiated Services Field: 0xc0 (DSCP: CS6, ECN: Not-ECT)<br>    Total Length: 84<br>    Identification: 0x6889 (26761)<br>    Flags: 0x00<br>    Fragment Offset: 0<br>    Time to Live: 64<br>    Protocol: ICMP (1)<br>    Header Checksum: 0xe3d0 [validation disabled]<br>    [Header checksum status: Unverified]<br>    Source Address: 192.168.86.1<br>    Destination Address: 192.168.86.61</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Protocol: ICMP (1).</span><br><span class="line"></span><br><span class="line">11.	Are the values in the Identification fields (across the sequence of all of ICMP packets from all of the routers) similar in behavior to your answer to question 9 above?</span><br><span class="line"></span><br><span class="line">Yes.</span><br><span class="line"></span><br><span class="line">12.	 Are the values of the TTL fields similar, across all of ICMP packets from all of the routers?</span><br><span class="line"></span><br><span class="line">All equals to 1.</span><br><span class="line"></span><br><span class="line">#### Part 2: Fragmentation</span><br><span class="line"></span><br><span class="line">14.	What information in the IP header indicates that this datagram been fragmented?</span><br></pre></td></tr></table></figure>
<p>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12<br>    0100 …. = Version: 4<br>    …. 0101 = Header Length: 20 bytes (5)<br>    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)<br>    Total Length: 1500<br>    Identification: 0xfda2 (64930)<br>    Flags: 0x20, More fragments<br>        0… …. = Reserved bit: Not set<br>        .0.. …. = Don’t fragment: Not set<br>        ..1. …. = More fragments: Set<br>    Fragment Offset: 0<br>    Time to Live: 1<br>    Protocol: UDP (17)<br>    Header Checksum: 0x0a05 [validation disabled]<br>    [Header checksum status: Unverified]<br>    Source Address: 192.168.86.61<br>    Destination Address: 128.119.245.12<br>    [Reassembled IPv4 in frame: 181]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Flags: 0x20, More fragments.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">15.	What information in the IP header for this packet indicates whether this is the first fragment versus a latter fragment?  </span><br><span class="line"></span><br><span class="line">Fragment Offset: 0 indicates it is the first fragment, offset is non-zero value indicates it is a latter fragment.</span><br><span class="line"></span><br><span class="line">16.	How many bytes are there in is this IP datagram (header plus payload)?</span><br><span class="line"></span><br><span class="line">Total Length: 1500.</span><br><span class="line"></span><br><span class="line">17.	Now inspect the datagram containing the second fragment of the fragmented UDP segment. What information in the IP header indicates that this is not the first datagram fragment?  </span><br><span class="line"></span><br><span class="line">Fragment Offset: 1480.</span><br><span class="line"></span><br><span class="line">18.	What fields change in the IP header between the first and second fragment?</span><br><span class="line"></span><br><span class="line">Fragment Offset and Header checksum.</span><br><span class="line"></span><br><span class="line">19.	Now find the IP datagram containing the third fragment of the original UDP segment. What information in the IP header indicates that this is the last fragment of that segment?</span><br></pre></td></tr></table></figure></p>
<p>Internet Protocol Version 4, Src: 192.168.86.61, Dst: 128.119.245.12<br>    0100 …. = Version: 4<br>    …. 0101 = Header Length: 20 bytes (5)<br>    Differentiated Services Field: 0x00 (DSCP: CS0, ECN: Not-ECT)<br>    Total Length: 40<br>    Identification: 0xfda2 (64930)<br>    Flags: 0x01<br>        0… …. = Reserved bit: Not set<br>        .0.. …. = Don’t fragment: Not set<br>        ..0. …. = More fragments: Not set<br>    Fragment Offset: 2960<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Flags: 0x01, ..0. .... = More fragments: Not set.</span><br><span class="line"></span><br><span class="line">### Capturing IPV6 packets</span><br><span class="line"></span><br><span class="line">Captured data:</span><br><span class="line"></span><br><span class="line">Answer the following questions , either from your own live trace, or by opening the Wireshark captured packet trace file  ip-wireshark-trace2-1.pcapng in  http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip  </span><br><span class="line"></span><br><span class="line">#### Part 3: IPv6</span><br><span class="line"></span><br><span class="line">Let’s start by taking a closer look at the 20th packet in this trace, sent at t=3.814489.  This is a DNS request (contained in an IPv6 datagram) to an IPv6 DNS server for the IPv6 address of youtube.com.</span><br><span class="line"></span><br><span class="line">20.	What is the IPv6 address of the computer making the DNS AAAA request?  This is the source address of the 20th packet in the trace. Give the IPv6 source address for this datagram in the exact same form as displayed in the Wireshark window .</span><br></pre></td></tr></table></figure></p>
<p>Internet Protocol Version 6, Src: 2601:193:8302:4620:215c:f5ae:8b40:a27a, Dst: 2001:558:feed::1<br>    0110 …. = Version: 6<br>    …. 0000 0000 …. …. …. …. …. = Traffic Class: 0x00 (DSCP: CS0, ECN: Not-ECT)<br>    …. …. …. 0110 0011 1110 1101 0000 = Flow Label: 0x63ed0<br>    Payload Length: 37<br>    Next Header: UDP (17)<br>    Hop Limit: 255<br>    Source Address: 2601:193:8302:4620:215c:f5ae:8b40:a27a<br>    Destination Address: 2001:558:feed::1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">2601:193:8302:4620:215c:f5ae:8b40:a27a</span><br><span class="line"></span><br><span class="line">21.	What is the IPv6 destination address for this datagram? Give this IPv6 address in the exact same form as displayed in the Wireshark window.  </span><br><span class="line"></span><br><span class="line">2001:558:feed::1</span><br><span class="line"></span><br><span class="line">22.	What is the value of the flow label for this datagram?</span><br><span class="line"></span><br><span class="line">.... .... .... 0110 0011 1110 1101 0000 = Flow Label: 0x63ed0</span><br><span class="line"></span><br><span class="line">23.	How much payload data is carried in this datagram?</span><br><span class="line"></span><br><span class="line">Payload Length: 37</span><br><span class="line"></span><br><span class="line">24.	What is the upper layer protocol to which this datagram’s payload will be delivered at the destination?</span><br><span class="line"></span><br><span class="line">Next Header: UDP (17)</span><br><span class="line"></span><br><span class="line">Lastly,  find the IPv6 DNS response to the IPv6 DNS AAAA request made in the 20th packet in this trace.  This DNS response contains IPv6 addresses for youtube.com.</span><br><span class="line"></span><br><span class="line">25.	How many IPv6 addresses are returned in the response to this AAAA request?</span><br></pre></td></tr></table></figure>
<p>Domain Name System (response)<br>    Transaction ID: 0x920d<br>    Flags: 0x8180 Standard query response, No error<br>    Questions: 1<br>    Answer RRs: 1<br>    Authority RRs: 0<br>    Additional RRs: 0<br>    Queries<br>    Answers<br>        youtube.com: type AAAA, class IN, addr 2607:f8b0:4006:815::200e<br>    [Request In: 20]<br>    [Time: 0.140916000 seconds]</p>
<p><code>`</code><br>Only one.</p>
<ol start="26">
<li>What is the first of the IPv6 addresses returned by the DNS for youtube.com (in the ip-wireshark-trace2-1.pcapng trace file, this is also the address that is numerically the smallest)? Give this IPv6 address in the exact same shorthand form as displayed in the Wireshark window.</li>
</ol>
<p>2607:f8b0:4006:815::200e.</p>
<h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><h3 id="Capturing-packets-from-an-execution-of-traceroute"><a href="#Capturing-packets-from-an-execution-of-traceroute" class="headerlink" title="Capturing packets from an execution of traceroute"></a>Capturing packets from an execution of traceroute</h3><p>Captured data:</p>
<p>Answer the following questions, either from your own live trace, or by opening the Wireshark captured packet trace file nat-inside-wireshark-trace1-1.pcapng and nat-outside-wireshark-trace1-1.pcapng in  <a href="http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip" target="_blank" rel="noopener">http://gaia.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip</a>  </p>
<p>Let’s first take a look at what’s happening on the LAN side of the NAT router. Open the nat-inside-wireshark-trace1-1.pcapng trace file. In this file, you should see an HTTP GET request addressed to the external web server at IP address 138.76.29.8, as well as the subsequent HTTP response message (“200 OK”). Both of these messages in the trace file were captured on the LAN side of the router. </p>
<ol>
<li>What is the IP address of the client that sends the HTTP GET request in the nat-inside-wireshark-trace1-1.pcapng trace? What is the source port number of the TCP segment in this datagram containing the HTTP GET request? What is the destination IP address of this HTTP GET request? What is the destination port number of the TCP segment in this datagram containing the HTTP GET request?</li>
</ol>
<p>Internet Protocol Version 4, Src: 192.168.10.11, Dst: 138.76.29.8</p>
<p>Transmission Control Protocol, Src Port: 53924, Dst Port: 80, Seq: 1, Ack: 1, Len: 330</p>
<ol start="2">
<li>At what time  is the corresponding HTTP 200 OK message from the webserver forwarded by the NAT router to the client on the router’s LAN side? </li>
</ol>
<p>[Time since first frame in this TCP stream: 0.030672101 seconds]<br>.</p>
<ol start="3">
<li>What are the source and destination IP addresses and TCP source and destination ports on the IP datagram carrying this HTTP 200 OK message?</li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 192.168.10.11</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924, Seq: 1, Ack: 331, Len: 547</p>
<p>In the following we’ll focus on these two HTTP messages (GET and 200 OK). Our goal below will be to locate these two HTTP messages in the trace file nat-outside-wireshark-trace1-1.pcapng, captured on the Internet-side link between the router and the ISP. Because the captured packets heading towards the server will have already been forwarded through the NAT router, some of the IP address and port numbers will have been changed as a result of NAT translation.</p>
<p>Open the trace file nat-outside-wireshark-trace1-1.pcapng. Note that the time stamps in this file and the nat-inside-wireshark-trace1-1.pcapng file are not necessarily synchronized. </p>
<p>In the nat-outside-wireshark-trace1-1.pcapng trace file, find the HTTP GET message that corresponds to the HTTP GET message that was sent from the client to the 138.76.29.8 server at time t=0.27362245, where t=0.27362245 is the time at which this message was sent, as recorded in the nat-inside-wireshark-trace1-1.pcapng trace file.  </p>
<ol start="4">
<li>At what time does this HTTP GET message appear in the nat-outside-wireshark-trace1-1.pcapng trace file? </li>
</ol>
<p>[Time since first frame in this TCP stream: 0.027356291 seconds]<br>.</p>
<ol start="5">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying this HTTP GET (as recorded in the nat-outside-wireshark-trace1-1.pcapng trace file)? </li>
</ol>
<p>Internet Protocol Version 4, Src: 10.0.1.254, Dst: 138.76.29.8<br>Transmission Control Protocol, Src Port: 53924, Dst Port: 80, Seq: 1, Ack: 1, Len: 330</p>
<ol start="6">
<li>Which of these four fields are different than in your answer to question 1 above?</li>
</ol>
<p>The source IP changed.</p>
<ol start="7">
<li>Are any fields in the HTTP GET message changed? </li>
</ol>
<p>None.</p>
<ol start="8">
<li>Which of the following fields in the IP datagram carrying the HTTP GET are changed from the datagram received on the local area network (inside) to the corresponding datagram forwarded on the Internet side (outside) of the NAT router: Version, Header Length, Flags, Checksum?</li>
</ol>
<p>Checksum changed.</p>
<p>Let’s continue to look at the nat-outside-wireshark-trace1-1.pcapng trace file. Find the HTTP reply containing the “200 OK” message that was received in response to the HTTP GET request you just examined in questions 4-8 above.</p>
<ol start="9">
<li>At what time does this message appear in the nat-outside-wireshark-trace1-1.pcapng trace file? </li>
</ol>
<p>[Time since first frame in this TCP stream: 0.030625966 seconds]<br>.</p>
<ol start="10">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying this HTTP reply (“200 OK”) message (as recorded in the nat-outside-wireshark-trace1-1.pcapng trace file)? </li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 10.0.1.254</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924, Seq: 1, Ack: 331, Len: 547</p>
<p>Lastly, let’s consider what happens when the NAT router receives this datagram that you examined in questions 9 and 10, performs NAT translation, and finally forwards that datagram to the destination host on the LAN side. Based on your answers to questions 1 through 10 above and your knowledge of how NAT works, you should be able to answer the following question without actually looking at the nat-inside-wireshark-trace1-1.pcapng trace file:</p>
<ol start="11">
<li>What are the source and destination IP addresses and TCP source and destination port numbers on the IP datagram carrying the HTTP reply (“200 OK”) that is forwarded from the router to the destination host in the right of Figure 1?</li>
</ol>
<p>Internet Protocol Version 4, Src: 138.76.29.8, Dst: 192.168.10.11</p>
<p>Transmission Control Protocol, Src Port: 80, Dst Port: 53924</p>
<h2 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h2><h2 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h2><h2 id="Ethernet-and-ARP"><a href="#Ethernet-and-ARP" class="headerlink" title="Ethernet and ARP"></a>Ethernet and ARP</h2><h2 id="802-11-WiFi"><a href="#802-11-WiFi" class="headerlink" title="802.11 WiFi"></a>802.11 WiFi</h2><h2 id="SSL-currently-being-updated-to-TLS"><a href="#SSL-currently-being-updated-to-TLS" class="headerlink" title="SSL (currently being updated to TLS)"></a>SSL (currently being updated to TLS)</h2><h2 id="IP"><a href="#IP" class="headerlink" title="IP"></a>IP</h2><h1 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h1><p><div id="refer-anchor-1"></div></p>
<ul>
<li>[1] <a href="https://gaia.cs.umass.edu/kurose_ross/wireshark.php" target="_blank" rel="noopener">Umass Wireshark labs</a></li>
</ul>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>John.Jersey
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://xigou.github.io/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/" title="Wireshark experements of <i>Computer Networks: Top-Down Approach</i>">https://xigou.github.io/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Computer-Network/" rel="tag"># Computer Network</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/04/28/2019-04-28-Group-testing/" rel="prev" title="[Group testing]群组测试：毒药谜题">
      <i class="fa fa-chevron-left"></i> [Group testing]群组测试：毒药谜题
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/12/14/Modern-Code-Review:-A-Case-Study-at-Google/" rel="next" title="<i>[Literature Reading]</i> Modern Code Review: A Case Study at Google">
      <i>[Literature Reading]</i> Modern Code Review: A Case Study at Google <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#intruduction"><span class="nav-number">1.</span> <span class="nav-text">intruduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Experiments"><span class="nav-number">2.</span> <span class="nav-text">Experiments</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic-skill-capturing-packets-using-Wireshark"><span class="nav-number">2.1.</span> <span class="nav-text">Basic skill: capturing packets using Wireshark</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP"><span class="nav-number">2.2.</span> <span class="nav-text">HTTP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Basic-HTTP-GET-response-interaction"><span class="nav-number">2.2.1.</span> <span class="nav-text">The Basic HTTP GET/response interaction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-HTTP-CONDITIONAL-GET-response-interaction"><span class="nav-number">2.2.2.</span> <span class="nav-text">The HTTP CONDITIONAL GET/response interaction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Retrieving-Long-Documents"><span class="nav-number">2.2.3.</span> <span class="nav-text">Retrieving Long Documents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-Documents-with-Embedded-Objects"><span class="nav-number">2.2.4.</span> <span class="nav-text">HTML Documents with Embedded Objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-Authentication"><span class="nav-number">2.2.5.</span> <span class="nav-text">HTTP Authentication</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DNS"><span class="nav-number">2.3.</span> <span class="nav-text">DNS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Trace-DNS-from-web-browser"><span class="nav-number">2.3.1.</span> <span class="nav-text">Trace DNS from web browser</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Trace-DNS-from-nslookup"><span class="nav-number">2.3.2.</span> <span class="nav-text">Trace DNS from nslookup</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Trace-DNS-from-nslookup-with-NS-type-record"><span class="nav-number">2.3.3.</span> <span class="nav-text">Trace DNS from nslookup with NS type record</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP"><span class="nav-number">2.4.</span> <span class="nav-text">TCP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Upload-a-150-KB-file"><span class="nav-number">2.4.1.</span> <span class="nav-text">Upload a 150+ KB file</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NAT"><span class="nav-number">2.5.</span> <span class="nav-text">NAT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Capturing-packets-from-an-execution-of-traceroute"><span class="nav-number">2.5.1.</span> <span class="nav-text">Capturing packets from an execution of traceroute</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DHCP"><span class="nav-number">2.6.</span> <span class="nav-text">DHCP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP"><span class="nav-number">2.7.</span> <span class="nav-text">ICMP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ethernet-and-ARP"><span class="nav-number">2.8.</span> <span class="nav-text">Ethernet and ARP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#802-11-WiFi"><span class="nav-number">2.9.</span> <span class="nav-text">802.11 WiFi</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSL-currently-being-updated-to-TLS"><span class="nav-number">2.10.</span> <span class="nav-text">SSL (currently being updated to TLS)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IP"><span class="nav-number">2.11.</span> <span class="nav-text">IP</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Refs"><span class="nav-number">3.</span> <span class="nav-text">Refs</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John.Jersey</p>
  <div class="site-description" itemprop="description">一个不愿意透露姓名的粉丝</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/XiGou" title="GitHub → https://github.com/XiGou" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:gouxivae@gmail.com" title="E-Mail → mailto:gouxivae@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>English</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="">
      
        <option value="en" data-href="/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/" selected="">
          English
        </option>
      
        <option value="zh-CN" data-href="/zh-CN/2021/09/04/Computer-Networks-Top-Down-Approach-s-wireshark-experements copy/" selected="">
          简体中文
        </option>
      
    </select>
  </div>

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John.Jersey</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  













<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'neutral',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '75f656cc2df38ffe043e',
      clientSecret: 'c0c01f2edb6850982db45a4591280de7114bbf76',
      repo        : 'xigou.github.io',
      owner       : 'XiGou',
      admin       : ['XiGou'],
      id          : 'c1208b30bfd8058e9391a9259738f094',
        language: 'en,zh-CN,zh-TW',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
