"use strict";(self.webpackChunkpersonal_blog=self.webpackChunkpersonal_blog||[]).push([["6404"],{46808:function(t,e,a){a.d(e,{GZ:()=>M,W6:()=>b,hE:()=>S});var l=a(58155),r=a(13724),i=a(67876),n=a(77311),s=a(60513);function h(t,{markdownAutoWrap:e}){let a=t.replace(/<br\/>/g,"\n").replace(/\n{2,}/g,"\n"),l=(0,s.T)(a);return!1===e?l.replace(/ /g,"&nbsp;"):l}function o(t,e={}){let a=h(t,e),l=n.xI.lexer(a),i=[[]],s=0;function d(t,e="normal"){"text"===t.type?t.text.split("\n").forEach((t,a)=>{0!==a&&(s++,i.push([])),t.split(" ").forEach(t=>{(t=t.replace(/&#39;/g,"'"))&&i[s].push({content:t,type:e})})}):"strong"===t.type||"em"===t.type?t.tokens.forEach(e=>{d(e,t.type)}):"html"===t.type&&i[s].push({content:t.text,type:"normal"})}return(0,r.K2)(d,"processNode"),l.forEach(t=>{"paragraph"===t.type?t.tokens?.forEach(t=>{d(t)}):"html"===t.type&&i[s].push({content:t.text,type:"normal"})}),i}function d(t,{markdownAutoWrap:e}={}){let a=n.xI.lexer(t);function l(t){if("text"===t.type)return!1===e?t.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):t.text.replace(/\n */g,"<br/>");if("strong"===t.type)return`<strong>${t.tokens?.map(l).join("")}</strong>`;if("em"===t.type)return`<em>${t.tokens?.map(l).join("")}</em>`;if("paragraph"===t.type)return`<p>${t.tokens?.map(l).join("")}</p>`;if("space"===t.type)return"";else if("html"===t.type)return`${t.text}`;else if("escape"===t.type)return t.text;return`Unsupported markdown: ${t.type}`}return(0,r.K2)(l,"output"),a.map(l).join("")}function c(t){return Intl.Segmenter?[...new Intl.Segmenter().segment(t)].map(t=>t.segment):[...t]}function g(t,e){return y(t,[],c(e.content),e.type)}function y(t,e,a,l){if(0===a.length)return[{content:e.join(""),type:l},{content:"",type:l}];let[r,...i]=a,n=[...e,r];return t([{content:n.join(""),type:l}])?y(t,n,i,l):(0===e.length&&r&&(e.push(r),a.shift()),[{content:e.join(""),type:l},{content:a.join(""),type:l}])}function p(t,e){if(t.some(({content:t})=>t.includes("\n")))throw Error("splitLineToFitWidth does not support newlines in the line");return f(t,e)}function f(t,e,a=[],l=[]){if(0===t.length)return l.length>0&&a.push(l),a.length>0?a:[];let r="";" "===t[0].content&&(r=" ",t.shift());let i=t.shift()??{content:" ",type:"normal"},n=[...l];if(""!==r&&n.push({content:r,type:"normal"}),n.push(i),e(n))return f(t,e,a,n);if(l.length>0)a.push(l),t.unshift(i);else if(i.content){let[l,r]=g(e,i);a.push([l]),r.content&&t.unshift(r)}return f(t,e,a)}function u(t,e){e&&t.attr("style",e)}async function m(t,e,a,l,i=!1){let n=t.append("foreignObject");n.attr("width",`${10*a}px`),n.attr("height",`${10*a}px`);let s=n.append("xhtml:div"),h=e.label;e.label&&(0,r.Wi)(e.label)&&(h=await (0,r.VJ)(e.label.replace(r.Y2.lineBreakRegex,"\n"),(0,r.D7)()));let o=e.isNode?"nodeLabel":"edgeLabel",d=s.append("span");d.html(h),u(d,e.labelStyle),d.attr("class",`${o} ${l}`),u(s,e.labelStyle),s.style("display","table-cell"),s.style("white-space","nowrap"),s.style("line-height","1.5"),s.style("max-width",a+"px"),s.style("text-align","center"),s.attr("xmlns","http://www.w3.org/1999/xhtml"),i&&s.attr("class","labelBkg");let c=s.node().getBoundingClientRect();return c.width===a&&(s.style("display","table"),s.style("white-space","break-spaces"),s.style("width",a+"px"),c=s.node().getBoundingClientRect()),n.node()}function x(t,e,a){return t.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",e*a-.1+"em").attr("dy",a+"em")}function w(t,e,a){let l=t.append("text"),r=x(l,1,e);k(r,a);let i=r.node().getComputedTextLength();return l.remove(),i}function b(t,e,a){let l=t.append("text"),r=x(l,1,e);k(r,[{content:a,type:"normal"}]);let i=r.node()?.getBoundingClientRect();return i&&l.remove(),i}function $(t,e,a,l=!1){let i=e.append("g"),n=i.insert("rect").attr("class","background").attr("style","stroke: none"),s=i.append("text").attr("y","-10.1"),h=0;for(let e of a){let a=(0,r.K2)(e=>w(i,1.1,e)<=t,"checkWidth");for(let t of a(e)?[e]:p(e,a))k(x(s,h,1.1),t),h++}if(!l)return s.node();{let t=s.node().getBBox();return n.attr("x",t.x-2).attr("y",t.y-2).attr("width",t.width+4).attr("height",t.height+4),i.node()}}function k(t,e){t.text(""),e.forEach((e,a)=>{let l=t.append("tspan").attr("font-style","em"===e.type?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight","strong"===e.type?"bold":"normal");0===a?l.text(e.content):l.text(" "+e.content)})}function S(t){return t.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}(0,r.K2)(h,"preprocessMarkdown"),(0,r.K2)(o,"markdownToLines"),(0,r.K2)(d,"markdownToHTML"),(0,r.K2)(c,"splitTextToChars"),(0,r.K2)(g,"splitWordToFitWidth"),(0,r.K2)(y,"splitWordToFitWidthRecursion"),(0,r.K2)(p,"splitLineToFitWidth"),(0,r.K2)(f,"splitLineToFitWidthRecursion"),(0,r.K2)(u,"applyStyle"),(0,r.K2)(m,"addHtmlSpan"),(0,r.K2)(x,"createTspan"),(0,r.K2)(w,"computeWidthOfText"),(0,r.K2)(b,"computeDimensionOfText"),(0,r.K2)($,"createFormattedText"),(0,r.K2)(k,"updateTextContentAndStyles"),(0,r.K2)(S,"replaceIconSubstring");var M=(0,r.K2)(async(t,e="",{style:a="",isTitle:n=!1,classes:s="",useHtmlLabels:h=!0,isNode:c=!0,width:g=200,addSvgBackground:y=!1}={},p)=>{if(r.Rm.debug("XYZ createText",e,a,n,s,h,c,"addSvgBackground: ",y),h){let i=d(e,p),n=S((0,l.Sm)(i)),h=e.replace(/\\\\/g,"\\"),o={isNode:c,label:(0,r.Wi)(e)?h:n,labelStyle:a.replace("fill:","color:")};return await m(t,o,g,s,y)}{let l=$(g,t,o(e.replace(/<br\s*\/?>/g,"<br/>").replace("<br>","<br/>"),p),!!e&&y);if(c){/stroke:/.exec(a)&&(a=a.replace("stroke:","lineColor:"));let t=a.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");(0,i.Ltv)(l).attr("style",t)}else{let t=a.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");(0,i.Ltv)(l).select("rect").attr("style",t.replace(/background:/g,"fill:"));let e=a.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");(0,i.Ltv)(l).select("text").attr("style",e)}return l}},"createText")},69630:function(t,e,a){a.d(e,{Gc:()=>o,WY:()=>p,pC:()=>g});var l=a(13724),r=a(66393),i=a(44513),n=a(897),s=a(36736),h=a(81712),o={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},d=new Map,c=new Map,g=(0,l.K2)(t=>{for(let e of t){if(!e.name)throw Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(l.Rm.debug("Registering icon pack:",e.name),"loader"in e)c.set(e.name,e.loader);else if("icons"in e)d.set(e.name,e.icons);else throw l.Rm.error("Invalid icon loader:",e),Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),y=(0,l.K2)(async(t,e)=>{let a=(0,r.ct)(t,!0,void 0!==e);if(!a)throw Error(`Invalid icon name: ${t}`);let n=a.prefix||e;if(!n)throw Error(`Icon name must contain a prefix: ${t}`);let s=d.get(n);if(!s){let t=c.get(n);if(!t)throw Error(`Icon set not found: ${a.prefix}`);try{s={...await t(),prefix:n},d.set(n,s)}catch(t){throw l.Rm.error(t),Error(`Failed to load icon set: ${a.prefix}`)}}let h=(0,i.y)(s,a.name);if(!h)throw Error(`Icon not found: ${t}`);return h},"getRegisteredIconData"),p=(0,l.K2)(async(t,e)=>{let a;try{a=await y(t,e?.fallbackPrefix)}catch(t){l.Rm.error(t),a=o}let r=(0,n.p)(a,e);return(0,s.U)((0,h.$)(r.body),r.attributes)},"getIconSVG")},16719:function(t,e,a){a.d(e,{DA:()=>b,IU:()=>T,KX:()=>D,U:()=>P,U7:()=>ec,U_:()=>ey,Zk:()=>d,aP:()=>eh,gh:()=>eg,lC:()=>g,on:()=>ed});var l=a(27627),r=a(69630),i=a(46808),n=a(58155),s=a(13724),h=a(67876),o=a(52274),d=(0,s.K2)(async(t,e,a)=>{let l,r=e.useHtmlLabels||(0,s._3)((0,s.D7)()?.htmlLabels),o=t.insert("g").attr("class",a||"node default").attr("id",e.domId||e.id),d=o.insert("g").attr("class","label").attr("style",(0,n.KL)(e.labelStyle));l=void 0===e.label?"":"string"==typeof e.label?e.label:e.label[0];let c=await (0,i.GZ)(d,(0,s.jZ)((0,n.Sm)(l),(0,s.D7)()),{useHtmlLabels:r,width:e.width||(0,s.D7)().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img}),g=c.getBBox(),y=(e?.padding??0)/2;if(r){let t=c.children[0],e=(0,h.Ltv)(c),a=t.getElementsByTagName("img");if(a){let t=""===l.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function l(){if(e.style.display="flex",e.style.flexDirection="column",t){let t=(0,s.D7)().fontSize?(0,s.D7)().fontSize:window.getComputedStyle(document.body).fontSize,[a=s.UI.fontSize]=(0,n.I5)(t),l=5*a+"px";e.style.minWidth=l,e.style.maxWidth=l}else e.style.width="100%";a(e)}(0,s.K2)(l,"setupImage"),setTimeout(()=>{e.complete&&l()}),e.addEventListener("error",l),e.addEventListener("load",l)})))}g=t.getBoundingClientRect(),e.attr("width",g.width),e.attr("height",g.height)}return r?d.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"):d.attr("transform","translate(0, "+-g.height/2+")"),e.centerLabel&&d.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"),d.insert("rect",":first-child"),{shapeSvg:o,bbox:g,halfPadding:y,label:d}},"labelHelper"),c=(0,s.K2)(async(t,e,a)=>{let l=a.useHtmlLabels||(0,s._3)((0,s.D7)()?.flowchart?.htmlLabels),r=t.insert("g").attr("class","label").attr("style",a.labelStyle||""),o=await (0,i.GZ)(r,(0,s.jZ)((0,n.Sm)(e),(0,s.D7)()),{useHtmlLabels:l,width:a.width||(0,s.D7)()?.flowchart?.wrappingWidth,style:a.labelStyle,addSvgBackground:!!a.icon||!!a.img}),d=o.getBBox(),c=a.padding/2;if((0,s._3)((0,s.D7)()?.flowchart?.htmlLabels)){let t=o.children[0],e=(0,h.Ltv)(o);d=t.getBoundingClientRect(),e.attr("width",d.width),e.attr("height",d.height)}return l?r.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"):r.attr("transform","translate(0, "+-d.height/2+")"),a.centerLabel&&r.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),r.insert("rect",":first-child"),{shapeSvg:t,bbox:d,halfPadding:c,label:r}},"insertLabel"),g=(0,s.K2)((t,e)=>{let a=e.node().getBBox();t.width=a.width,t.height=a.height},"updateNodeBounds"),y=(0,s.K2)((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function p(t){let e=t.map((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`);return e.push("Z"),e.join(" ")}function f(t,e,a,l,r,i){let n=[],s=a-t,h=2*Math.PI/(s/i),o=e+(l-e)/2;for(let e=0;e<=50;e++){let a=t+e/50*s,l=o+r*Math.sin(h*(a-t));n.push({x:a,y:l})}return n}function u(t,e,a,l,r,i){let n=[],s=r*Math.PI/180,h=(i*Math.PI/180-s)/(l-1);for(let r=0;r<l;r++){let l=s+r*h,i=t+a*Math.cos(l),o=e+a*Math.sin(l);n.push({x:-i,y:-o})}return n}(0,s.K2)(p,"createPathFromPoints"),(0,s.K2)(f,"generateFullSineWavePoints"),(0,s.K2)(u,"generateCirclePoints");var m=(0,s.K2)((t,e)=>{var a,l,r=t.x,i=t.y,n=e.x-r,s=e.y-i,h=t.width/2,o=t.height/2;return Math.abs(s)*h>Math.abs(n)*o?(s<0&&(o=-o),a=0===s?0:o*n/s,l=o):(n<0&&(h=-h),a=h,l=0===n?0:h*s/n),{x:r+a,y:i+l}},"intersectRect");function x(t,e){e&&t.attr("style",e)}async function w(t){let e=(0,h.Ltv)(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div"),l=t.label;t.label&&(0,s.Wi)(t.label)&&(l=await (0,s.VJ)(t.label.replace(s.Y2.lineBreakRegex,"\n"),(0,s.D7)()));let r=t.isNode?"nodeLabel":"edgeLabel";return a.html('<span class="'+r+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+l+"</span>"),x(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}(0,s.K2)(x,"applyStyle"),(0,s.K2)(w,"addHtmlLabel");var b=(0,s.K2)(async(t,e,a,l)=>{let r=t||"";if("object"==typeof r&&(r=r[0]),(0,s._3)((0,s.D7)().flowchart.htmlLabels)){r=r.replace(/\\n|\n/g,"<br />"),s.Rm.info("vertexText"+r);let t={isNode:l,label:(0,n.Sm)(r).replace(/fa[blrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`),labelStyle:e?e.replace("fill:","color:"):e};return await w(t)}{let t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",e.replace("color:","fill:"));for(let e of"string"==typeof r?r.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(r)?r:[]){let l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),a?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=e.trim(),t.appendChild(l)}return t}},"createLabel"),$=(0,s.K2)((t,e,a,l,r)=>["M",t+r,e,"H",t+a-r,"A",r,r,"0 0 1",t+a,e+r,"V",e+l-r,"A",r,r,"0 0 1",t+a-r,e+l,"H",t+r,"A",r,r,"0 0 1",t,e+l-r,"V",e+r,"A",r,r,"0 0 1",t+r,e,"Z"].join(" "),"createRoundedRectPathD"),k=(0,s.K2)(t=>{let{handDrawnSeed:e}=(0,s.D7)();return{fill:t,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:t,seed:e}},"solidStateFill"),S=(0,s.K2)(t=>{let e=M([...t.cssCompiledStyles||[],...t.cssStyles||[]]);return{stylesMap:e,stylesArray:[...e]}},"compileStyles"),M=(0,s.K2)(t=>{let e=new Map;return t.forEach(t=>{let[a,l]=t.split(":");e.set(a.trim(),l?.trim())}),e},"styles2Map"),D=(0,s.K2)(t=>"color"===t||"font-size"===t||"font-family"===t||"font-weight"===t||"font-style"===t||"text-decoration"===t||"text-align"===t||"text-transform"===t||"line-height"===t||"letter-spacing"===t||"word-spacing"===t||"text-shadow"===t||"text-overflow"===t||"white-space"===t||"word-wrap"===t||"word-break"===t||"overflow-wrap"===t||"hyphens"===t,"isLabelStyle"),v=(0,s.K2)(t=>{let{stylesArray:e}=S(t),a=[],l=[],r=[],i=[];return e.forEach(t=>{let e=t[0];D(e)?a.push(t.join(":")+" !important"):(l.push(t.join(":")+" !important"),e.includes("stroke")&&r.push(t.join(":")+" !important"),"fill"===e&&i.push(t.join(":")+" !important"))}),{labelStyles:a.join(";"),nodeStyles:l.join(";"),stylesArray:e,borderStyles:r,backgroundStyles:i}},"styles2String"),A=(0,s.K2)((t,e)=>{let{themeVariables:a,handDrawnSeed:l}=(0,s.D7)(),{nodeBorder:r,mainBkg:i}=a,{stylesMap:n}=S(t);return Object.assign({roughness:.7,fill:n.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:n.get("stroke")||r,seed:l,strokeWidth:n.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},e)},"userNodeOverrides"),K=(0,s.K2)(async(t,e)=>{let a;s.Rm.info("Creating subgraph rect for ",e.id,e);let r=(0,s.D7)(),{themeVariables:n,handDrawnSeed:d}=r,{clusterBkg:c,clusterBorder:g}=n,{labelStyles:y,nodeStyles:p,borderStyles:f,backgroundStyles:u}=v(e),x=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),w=(0,s._3)(r.flowchart.htmlLabels),b=x.insert("g").attr("class","cluster-label "),k=await (0,i.GZ)(b,e.label,{style:e.labelStyle,useHtmlLabels:w,isNode:!0}),S=k.getBBox();if((0,s._3)(r.flowchart.htmlLabels)){let t=k.children[0],e=(0,h.Ltv)(k);S=t.getBoundingClientRect(),e.attr("width",S.width),e.attr("height",S.height)}let M=e.width<=S.width+e.padding?S.width+e.padding:e.width;e.width<=S.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;let D=e.height,K=e.x-M/2,C=e.y-D/2;if(s.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){let t=o.A.svg(x),l=A(e,{roughness:.7,fill:c,stroke:g,fillWeight:3,seed:d}),r=t.path($(K,C,M,D,0),l);(a=x.insert(()=>(s.Rm.debug("Rough node insert CXC",r),r),":first-child")).select("path:nth-child(2)").attr("style",f.join(";")),a.select("path").attr("style",u.join(";").replace("fill","stroke"))}else(a=x.insert("rect",":first-child")).attr("style",p).attr("rx",e.rx).attr("ry",e.ry).attr("x",K).attr("y",C).attr("width",M).attr("height",D);let{subGraphTitleTopMargin:B}=(0,l.O)(r);if(b.attr("transform",`translate(${e.x-S.width/2}, ${e.y-e.height/2+B})`),y){let t=b.select("span");t&&t.attr("style",y)}let L=a.node().getBBox();return e.offsetX=0,e.width=L.width,e.height=L.height,e.offsetY=S.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:x,labelBBox:S}},"rect"),C=(0,s.K2)((t,e)=>{let a=t.insert("g").attr("class","note-cluster").attr("id",e.id),l=a.insert("rect",":first-child"),r=0*e.padding,i=r/2;l.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-i).attr("y",e.y-e.height/2-i).attr("width",e.width+r).attr("height",e.height+r).attr("fill","none");let n=l.node().getBBox();return e.width=n.width,e.height=n.height,e.intersect=function(t){return m(e,t)},{cluster:a,labelBBox:{width:0,height:0}}},"noteGroup"),B=(0,s.K2)(async(t,e)=>{let a,l=(0,s.D7)(),{themeVariables:r,handDrawnSeed:i}=l,{altBackground:n,compositeBackground:d,compositeTitleBackground:c,nodeBorder:g}=r,y=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),p=y.insert("g",":first-child"),f=y.insert("g").attr("class","cluster-label"),u=y.append("rect"),x=f.node().appendChild(await b(e.label,e.labelStyle,void 0,!0)),w=x.getBBox();if((0,s._3)(l.flowchart.htmlLabels)){let t=x.children[0],e=(0,h.Ltv)(x);w=t.getBoundingClientRect(),e.attr("width",w.width),e.attr("height",w.height)}let k=0*e.padding,S=(e.width<=w.width+e.padding?w.width+e.padding:e.width)+k;e.width<=w.width+e.padding?e.diff=(S-e.width)/2-e.padding:e.diff=-e.padding;let M=e.height+k,D=e.height+k-w.height-6,v=e.x-S/2,A=e.y-M/2;e.width=S;let K=e.y-e.height/2-k/2+w.height+2;if("handDrawn"===e.look){let t=e.cssClasses.includes("statediagram-cluster-alt"),l=o.A.svg(y),r=e.rx||e.ry?l.path($(v,A,S,M,10),{roughness:.7,fill:c,fillStyle:"solid",stroke:g,seed:i}):l.rectangle(v,A,S,M,{seed:i});a=y.insert(()=>r,":first-child");let s=l.rectangle(v,K,S,D,{fill:t?n:d,fillStyle:t?"hachure":"solid",stroke:g,seed:i});a=y.insert(()=>r,":first-child"),u=y.insert(()=>s)}else(a=p.insert("rect",":first-child")).attr("class","outer").attr("x",v).attr("y",A).attr("width",S).attr("height",M).attr("data-look",e.look),u.attr("class","inner").attr("x",v).attr("y",K).attr("width",S).attr("height",D);return f.attr("transform",`translate(${e.x-w.width/2}, ${A+1-3*!(0,s._3)(l.flowchart.htmlLabels)})`),e.height=a.node().getBBox().height,e.offsetX=0,e.offsetY=w.height-e.padding/2,e.labelBBox=w,e.intersect=function(t){return m(e,t)},{cluster:y,labelBBox:w}},"roundedWithTitle"),L=(0,s.K2)(async(t,e)=>{let a;s.Rm.info("Creating subgraph rect for ",e.id,e);let r=(0,s.D7)(),{themeVariables:n,handDrawnSeed:d}=r,{clusterBkg:c,clusterBorder:g}=n,{labelStyles:y,nodeStyles:p,borderStyles:f,backgroundStyles:u}=v(e),x=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),w=(0,s._3)(r.flowchart.htmlLabels),b=x.insert("g").attr("class","cluster-label "),k=await (0,i.GZ)(b,e.label,{style:e.labelStyle,useHtmlLabels:w,isNode:!0,width:e.width}),S=k.getBBox();if((0,s._3)(r.flowchart.htmlLabels)){let t=k.children[0],e=(0,h.Ltv)(k);S=t.getBoundingClientRect(),e.attr("width",S.width),e.attr("height",S.height)}let M=e.width<=S.width+e.padding?S.width+e.padding:e.width;e.width<=S.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;let D=e.height,K=e.x-M/2,C=e.y-D/2;if(s.Rm.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){let t=o.A.svg(x),l=A(e,{roughness:.7,fill:c,stroke:g,fillWeight:4,seed:d}),r=t.path($(K,C,M,D,e.rx),l);(a=x.insert(()=>(s.Rm.debug("Rough node insert CXC",r),r),":first-child")).select("path:nth-child(2)").attr("style",f.join(";")),a.select("path").attr("style",u.join(";").replace("fill","stroke"))}else(a=x.insert("rect",":first-child")).attr("style",p).attr("rx",e.rx).attr("ry",e.ry).attr("x",K).attr("y",C).attr("width",M).attr("height",D);let{subGraphTitleTopMargin:B}=(0,l.O)(r);if(b.attr("transform",`translate(${e.x-S.width/2}, ${e.y-e.height/2+B})`),y){let t=b.select("span");t&&t.attr("style",y)}let L=a.node().getBBox();return e.offsetX=0,e.width=L.width,e.height=L.height,e.offsetY=S.height-e.padding/2,e.intersect=function(t){return m(e,t)},{cluster:x,labelBBox:S}},"kanbanSection"),R={rect:K,squareRect:K,roundedWithTitle:B,noteGroup:C,divider:(0,s.K2)((t,e)=>{let a,{themeVariables:l,handDrawnSeed:r}=(0,s.D7)(),{nodeBorder:i}=l,n=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),h=n.insert("g",":first-child"),d=0*e.padding,c=e.width+d;e.diff=-e.padding;let g=e.height+d,y=e.x-c/2,p=e.y-g/2;if(e.width=c,"handDrawn"===e.look){let t=o.A.svg(n).rectangle(y,p,c,g,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:r});a=n.insert(()=>t,":first-child")}else(a=h.insert("rect",":first-child")).attr("class","divider").attr("x",y).attr("y",p).attr("width",c).attr("height",g).attr("data-look",e.look);return e.height=a.node().getBBox().height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return m(e,t)},{cluster:n,labelBBox:{}}},"divider"),kanbanSection:L},N=new Map,P=(0,s.K2)(async(t,e)=>{let a=e.shape||"rect",l=await R[a](t,e);return N.set(e.id,l),l},"insertCluster"),T=(0,s.K2)(()=>{N=new Map},"clear");function I(t,e,a,l){var r=t.x,i=t.y,n=r-l.x,s=i-l.y,h=Math.sqrt(e*e*s*s+a*a*n*n),o=Math.abs(e*a*n/h);l.x<r&&(o=-o);var d=Math.abs(e*a*s/h);return l.y<i&&(d=-d),{x:r+o,y:i+d}}function W(t,e,a){return I(t,e,e,a)}function E(t,e,a,l){var r,i,n,s,h,o,d,c,g,y,p,f,u;if(r=e.y-t.y,n=t.x-e.x,h=e.x*t.y-t.x*e.y,g=r*a.x+n*a.y+h,y=r*l.x+n*l.y+h,!(0!==g&&0!==y&&j(g,y))){if((i=l.y-a.y,s=a.x-l.x,o=l.x*a.y-a.x*l.y,d=i*t.x+s*t.y+o,c=i*e.x+s*e.y+o,!(0!==d&&0!==c&&j(d,c)))&&0!=(p=r*s-i*n))return f=Math.abs(p/2),{x:(u=n*o-s*h)<0?(u-f)/p:(u+f)/p,y:(u=i*h-r*o)<0?(u-f)/p:(u+f)/p}}}function j(t,e){return t*e>0}function _(t,e,a){let l=t.x,r=t.y,i=[],n=1/0,s=1/0;"function"==typeof e.forEach?e.forEach(function(t){n=Math.min(n,t.x),s=Math.min(s,t.y)}):(n=Math.min(n,e.x),s=Math.min(s,e.y));let h=l-t.width/2-n,o=r-t.height/2-s;for(let l=0;l<e.length;l++){let r=e[l],n=e[l<e.length-1?l+1:0],s=E(t,a,{x:h+r.x,y:o+r.y},{x:h+n.x,y:o+n.y});s&&i.push(s)}return i.length?(i.length>1&&i.sort(function(t,e){let l=t.x-a.x,r=t.y-a.y,i=Math.sqrt(l*l+r*r),n=e.x-a.x,s=e.y-a.y,h=Math.sqrt(n*n+s*s);return i<h?-1:+(i!==h)}),i[0]):t}(0,s.K2)(function(t,e){return t.intersect(e)},"intersectNode"),(0,s.K2)(I,"intersectEllipse"),(0,s.K2)(W,"intersectCircle"),(0,s.K2)(E,"intersectLine"),(0,s.K2)(j,"sameSign"),(0,s.K2)(_,"intersectPolygon");function H(t,e){let{labelStyles:a}=v(e);e.labelStyle=a;let l=y(e),r=l;l||(r="anchor");let i=t.insert("g").attr("class",r).attr("id",e.domId||e.id),{cssStyles:h}=e,d=o.A.svg(i),c=A(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(c.roughness=0);let p=d.circle(0,0,2,c),f=i.insert(()=>p,":first-child");return f.attr("class","anchor").attr("style",(0,n.KL)(h)),g(e,f),e.intersect=function(t){return s.Rm.info("Circle intersect",e,1,t),W(e,1,t)},i}function z(t,e,a,l,r,i,n){let s=Math.atan2(l-e,a-t),h=Math.sqrt(((a-t)/2/r)**2+((l-e)/2/i)**2);if(h>1)throw Error("The given radii are too small to create an arc between the points.");let o=Math.sqrt(1-h**2),d=(t+a)/2+o*i*Math.sin(s)*(n?-1:1),c=(e+l)/2-o*r*Math.cos(s)*(n?-1:1),g=Math.atan2((e-c)/i,(t-d)/r),y=Math.atan2((l-c)/i,(a-d)/r)-g;n&&y<0&&(y+=2*Math.PI),!n&&y>0&&(y-=2*Math.PI);let p=[];for(let t=0;t<20;t++){let e=g+t/19*y,a=d+r*Math.cos(e),l=c+i*Math.sin(e);p.push({x:a,y:l})}return p}async function F(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=i.width+e.padding+20,s=i.height+e.padding,h=s/2,c=h/(2.5+s/50),{cssStyles:f}=e,u=[{x:n/2,y:-s/2},{x:-n/2,y:-s/2},...z(-n/2,-s/2,-n/2,s/2,c,h,!1),{x:n/2,y:s/2},...z(n/2,s/2,n/2,-s/2,c,h,!0)],m=o.A.svg(r),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=p(u),b=m.path(w,x),$=r.insert(()=>b,":first-child");return $.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",l),$.attr("transform",`translate(${c/2}, 0)`),g(e,$),e.intersect=function(t){return _(e,u,t)},r}function q(t,e,a,l){return t.insert("polygon",":first-child").attr("points",l.map(function(t){return t.x+","+t.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}async function O(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=n.height+e.padding,h=n.width+e.padding+12,c=-s,f=[{x:12,y:c},{x:h,y:c},{x:h,y:0},{x:0,y:0},{x:0,y:c+12},{x:12,y:c}],{cssStyles:u}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=p(f),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-h/2}, ${s/2})`),u&&a.attr("style",u)}else a=q(i,h,s,f);return r&&a.attr("style",r),g(e,a),e.intersect=function(t){return _(e,f,t)},i}function Z(t,e){let{nodeStyles:a}=v(e);e.label="";let l=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:r}=e,i=Math.max(28,e.width??0),n=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],s=o.A.svg(l),h=A(e,{});"handDrawn"!==e.look&&(h.roughness=0,h.fillStyle="solid");let d=p(n),c=s.path(d,h),g=l.insert(()=>c,":first-child");return r&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",r),a&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return _(e,n,t)},l}async function X(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:h,halfPadding:c}=await d(t,e,y(e)),p=h.width/2+c,{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=t.circle(0,0,2*p,l);(a=i.insert(()=>r,":first-child")).attr("class","basic label-container").attr("style",(0,n.KL)(f))}else a=i.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",p).attr("cx",0).attr("cy",0);return g(e,a),e.intersect=function(t){return s.Rm.info("Circle intersect",e,p,t),W(e,p,t)},i}function Y(t){let e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),l=2*t,r={x:l/2*e,y:l/2*a},i={x:-(l/2)*e,y:l/2*a},n={x:-(l/2)*e,y:-(l/2)*a},s={x:l/2*e,y:-(l/2)*a};return`M ${i.x},${i.y} L ${s.x},${s.y}
                   M ${r.x},${r.y} L ${n.x},${n.y}`}function G(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a,e.label="";let r=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),i=Math.max(30,e?.width??0),{cssStyles:n}=e,h=o.A.svg(r),d=A(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");let c=h.circle(0,0,2*i,d),p=Y(i),f=h.path(p,d),u=r.insert(()=>c,":first-child");return u.insert(()=>f),n&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",n),l&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",l),g(e,u),e.intersect=function(t){return s.Rm.info("crossedCircle intersect",e,{radius:i,point:t}),W(e,i,t)},r}function U(t,e,a,l=100,r=0,i=180){let n=[],s=r*Math.PI/180,h=(i*Math.PI/180-s)/(l-1);for(let r=0;r<l;r++){let l=s+r*h,i=t+a*Math.cos(l),o=e+a*Math.sin(l);n.push({x:-i,y:-o})}return n}async function V(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),c=Math.max(5,.1*h),{cssStyles:f}=e,u=[...U(s/2,-h/2,c,30,-90,0),{x:-s/2-c,y:c},...U(s/2+2*c,-c,c,20,-180,-270),...U(s/2+2*c,c,c,20,-90,-180),{x:-s/2-c,y:-h/2},...U(s/2,h/2,c,20,0,90)],m=[{x:s/2,y:-h/2-c},{x:-s/2,y:-h/2-c},...U(s/2,-h/2,c,20,-90,0),{x:-s/2-c,y:-c},...U(s/2+.1*s,-c,c,20,-180,-270),...U(s/2+.1*s,c,c,20,-90,-180),{x:-s/2-c,y:h/2},...U(s/2,h/2,c,20,0,90),{x:-s/2,y:h/2+c},{x:s/2,y:h/2+c}],x=o.A.svg(r),w=A(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");let b=p(u).replace("Z",""),$=x.path(b,w),k=p(m),S=x.path(k,{...w}),M=r.insert("g",":first-child");return M.insert(()=>S,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),f&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",l),M.attr("transform",`translate(${c}, 0)`),n.attr("transform",`translate(${-s/2+c-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),g(e,M),e.intersect=function(t){return _(e,m,t)},r}function J(t,e,a,l=100,r=0,i=180){let n=[],s=r*Math.PI/180,h=(i*Math.PI/180-s)/(l-1);for(let r=0;r<l;r++){let l=s+r*h,i=t+a*Math.cos(l),o=e+a*Math.sin(l);n.push({x:i,y:o})}return n}async function Q(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),c=Math.max(5,.1*h),{cssStyles:f}=e,u=[...J(s/2,-h/2,c,20,-90,0),{x:s/2+c,y:-c},...J(s/2+2*c,-c,c,20,-180,-270),...J(s/2+2*c,c,c,20,-90,-180),{x:s/2+c,y:h/2},...J(s/2,h/2,c,20,0,90)],m=[{x:-s/2,y:-h/2-c},{x:s/2,y:-h/2-c},...J(s/2,-h/2,c,20,-90,0),{x:s/2+c,y:-c},...J(s/2+2*c,-c,c,20,-180,-270),...J(s/2+2*c,c,c,20,-90,-180),{x:s/2+c,y:h/2},...J(s/2,h/2,c,20,0,90),{x:s/2,y:h/2+c},{x:-s/2,y:h/2+c}],x=o.A.svg(r),w=A(e,{fill:"none"});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");let b=p(u).replace("Z",""),$=x.path(b,w),k=p(m),S=x.path(k,{...w}),M=r.insert("g",":first-child");return M.insert(()=>S,":first-child").attr("stroke-opacity",0),M.insert(()=>$,":first-child"),M.attr("class","text"),f&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",l),M.attr("transform",`translate(${-c}, 0)`),n.attr("transform",`translate(${-s/2+(e.padding??0)/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),g(e,M),e.intersect=function(t){return _(e,m,t)},r}function tt(t,e,a,l=100,r=0,i=180){let n=[],s=r*Math.PI/180,h=(i*Math.PI/180-s)/(l-1);for(let r=0;r<l;r++){let l=s+r*h,i=t+a*Math.cos(l),o=e+a*Math.sin(l);n.push({x:-i,y:-o})}return n}async function te(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=i.width+(e.padding??0),h=i.height+(e.padding??0),c=Math.max(5,.1*h),{cssStyles:f}=e,u=[...tt(s/2,-h/2,c,30,-90,0),{x:-s/2-c,y:c},...tt(s/2+2*c,-c,c,20,-180,-270),...tt(s/2+2*c,c,c,20,-90,-180),{x:-s/2-c,y:-h/2},...tt(s/2,h/2,c,20,0,90)],m=[...tt(-s/2+c+c/2,-h/2,c,20,-90,-180),{x:s/2-c/2,y:c},...tt(-s/2-c/2,-c,c,20,0,90),...tt(-s/2-c/2,c,c,20,-90,0),{x:s/2-c/2,y:-c},...tt(-s/2+c+c/2,h/2,c,30,-180,-270)],x=[{x:s/2,y:-h/2-c},{x:-s/2,y:-h/2-c},...tt(s/2,-h/2,c,20,-90,0),{x:-s/2-c,y:-c},...tt(s/2+2*c,-c,c,20,-180,-270),...tt(s/2+2*c,c,c,20,-90,-180),{x:-s/2-c,y:h/2},...tt(s/2,h/2,c,20,0,90),{x:-s/2,y:h/2+c},{x:s/2-c-c/2,y:h/2+c},...tt(-s/2+c+c/2,-h/2,c,20,-90,-180),{x:s/2-c/2,y:c},...tt(-s/2-c/2,-c,c,20,0,90),...tt(-s/2-c/2,c,c,20,-90,0),{x:s/2-c/2,y:-c},...tt(-s/2+c+c/2,h/2,c,30,-180,-270)],w=o.A.svg(r),b=A(e,{fill:"none"});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");let $=p(u).replace("Z",""),k=w.path($,b),S=p(m).replace("Z",""),M=w.path(S,b),D=p(x),K=w.path(D,{...b}),C=r.insert("g",":first-child");return C.insert(()=>K,":first-child").attr("stroke-opacity",0),C.insert(()=>k,":first-child"),C.insert(()=>M,":first-child"),C.attr("class","text"),f&&"handDrawn"!==e.look&&C.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&C.selectAll("path").attr("style",l),C.attr("transform",`translate(${c-c/4}, 0)`),n.attr("transform",`translate(${-s/2+(e.padding??0)/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)/2-(i.y-(i.top??0))})`),g(e,C),e.intersect=function(t){return _(e,x,t)},r}async function ta(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(80,(i.width+(e.padding??0)*2)*1.25,e?.width??0),s=Math.max(20,i.height+(e.padding??0)*2,e?.height??0),h=s/2,{cssStyles:c}=e,f=o.A.svg(r),m=A(e,{});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");let x=n-h,w=s/4,b=[{x:x,y:0},{x:w,y:0},{x:0,y:s/2},{x:w,y:s},{x:x,y:s},...u(-x,-s/2,h,50,270,90)],$=p(b),k=f.path($,m),S=r.insert(()=>k,":first-child");return S.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&S.selectChildren("path").attr("style",c),l&&"handDrawn"!==e.look&&S.selectChildren("path").attr("style",l),S.attr("transform",`translate(${-n/2}, ${-s/2})`),g(e,S),e.intersect=function(t){return _(e,b,t)},r}(0,s.K2)(H,"anchor"),(0,s.K2)(z,"generateArcPoints"),(0,s.K2)(F,"bowTieRect"),(0,s.K2)(q,"insertPolygonShape"),(0,s.K2)(O,"card"),(0,s.K2)(Z,"choice"),(0,s.K2)(X,"circle"),(0,s.K2)(Y,"createLine"),(0,s.K2)(G,"crossedCircle"),(0,s.K2)(U,"generateCirclePoints"),(0,s.K2)(V,"curlyBraceLeft"),(0,s.K2)(J,"generateCirclePoints"),(0,s.K2)(Q,"curlyBraceRight"),(0,s.K2)(tt,"generateCirclePoints"),(0,s.K2)(te,"curlyBraces"),(0,s.K2)(ta,"curvedTrapezoid");var tl=(0,s.K2)((t,e,a,l,r,i)=>`M${t},${e+i} a${r},${i} 0,0,0 ${a},0 a${r},${i} 0,0,0 ${-a},0 l0,${l} a${r},${i} 0,0,0 ${a},0 l0,${-l}`,"createCylinderPathD"),tr=(0,s.K2)((t,e,a,l,r,i)=>`M${t},${e+i} M${t+a},${e+i} a${r},${i} 0,0,0 ${-a},0 l0,${l} a${r},${i} 0,0,0 ${a},0 l0,${-l}`,"createOuterCylinderPathD"),ti=(0,s.K2)((t,e,a,l,r,i)=>`M${t-a/2},${-l/2} a${r},${i} 0,0,0 ${a},0`,"createInnerCylinderPathD");async function tn(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:s,label:h}=await d(t,e,y(e)),c=Math.max(s.width+e.padding,e.width??0),p=c/2,f=p/(2.5+c/50),u=Math.max(s.height+f+e.padding,e.height??0),{cssStyles:x}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=tr(0,0,c,u,p,f),r=ti(0,f,c,u,p,f),n=t.path(l,A(e,{})),s=t.path(r,A(e,{fill:"none"}));a=i.insert(()=>s,":first-child"),(a=i.insert(()=>n,":first-child")).attr("class","basic label-container"),x&&a.attr("style",x)}else{let t=tl(0,0,c,u,p,f);a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,n.KL)(x)).attr("style",r)}return a.attr("label-offset-y",f),a.attr("transform",`translate(${-c/2}, ${-(u/2+f)})`),g(e,a),h.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+(e.padding??0)/1.5-(s.y-(s.top??0))})`),e.intersect=function(t){let a=m(e,t),l=a.x-(e.x??0);if(0!=p&&(Math.abs(l)<(e.width??0)/2||Math.abs(l)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let r=f*f*(1-l*l/(p*p));r>0&&(r=Math.sqrt(r)),r=f-r,t.y-(e.y??0)>0&&(r=-r),a.y+=r}return a},i}async function ts(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=i.width+e.padding,h=i.height+e.padding,c=.2*h,p=-s/2,f=-h/2-c/2,{cssStyles:u}=e,x=o.A.svg(r),w=A(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");let b=x.polygon([{x:p,y:f+c},{x:-p,y:f+c},{x:-p,y:-f},{x:p,y:-f},{x:p,y:f},{x:-p,y:f},{x:-p,y:f+c}].map(t=>[t.x,t.y]),w),$=r.insert(()=>b,":first-child");return $.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),l&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",l),n.attr("transform",`translate(${p+(e.padding??0)/2-(i.x-(i.left??0))}, ${f+c+(e.padding??0)/2-(i.y-(i.top??0))})`),g(e,$),e.intersect=function(t){return m(e,t)},r}async function th(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:h,halfPadding:c}=await d(t,e,y(e)),p=h.width/2+c+5,f=h.width/2+c,{cssStyles:u}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{roughness:.2,strokeWidth:2.5}),r=A(e,{roughness:.2,strokeWidth:1.5}),s=t.circle(0,0,2*p,l),h=t.circle(0,0,2*f,r);(a=i.insert("g",":first-child")).attr("class",(0,n.KL)(e.cssClasses)).attr("style",(0,n.KL)(u)),a.node()?.appendChild(s),a.node()?.appendChild(h)}else{let t=(a=i.insert("g",":first-child")).insert("circle",":first-child"),e=a.insert("circle");a.attr("class","basic label-container").attr("style",r),t.attr("class","outer-circle").attr("style",r).attr("r",p).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",r).attr("r",f).attr("cx",0).attr("cy",0)}return g(e,a),e.intersect=function(t){return s.Rm.info("DoubleCircle intersect",e,p,t),W(e,p,t)},i}function to(t,e,{config:{themeVariables:a}}){let{labelStyles:l,nodeStyles:r}=v(e);e.label="",e.labelStyle=l;let i=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:n}=e,h=o.A.svg(i),{nodeBorder:d}=a,c=A(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(c.roughness=0);let p=h.circle(0,0,14,c),f=i.insert(()=>p,":first-child");return f.selectAll("path").attr("style",`fill: ${d} !important;`),n&&n.length>0&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",n),r&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",r),g(e,f),e.intersect=function(t){return s.Rm.info("filledCircle intersect",e,{radius:7,point:t}),W(e,7,t)},i}async function td(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),h=i.width+(e.padding??0),c=h+i.height,f=h+i.height,u=[{x:0,y:-c},{x:f,y:-c},{x:f/2,y:0}],{cssStyles:m}=e,x=o.A.svg(r),w=A(e,{});"handDrawn"!==e.look&&(w.roughness=0,w.fillStyle="solid");let b=p(u),$=x.path(b,w),k=r.insert(()=>$,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return m&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",m),l&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",l),e.width=h,e.height=c,g(e,k),n.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-c/2+(e.padding??0)/2+(i.y-(i.top??0))})`),e.intersect=function(t){return s.Rm.info("Triangle intersect",e,u,t),_(e,u,t)},r}function tc(t,e,{dir:a,config:{state:l,themeVariables:r}}){let{nodeStyles:i}=v(e);e.label="";let n=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:s}=e,h=Math.max(70,e?.width??0),d=Math.max(10,e?.height??0);"LR"===a&&(h=Math.max(10,e?.width??0),d=Math.max(70,e?.height??0));let c=-1*h/2,p=-1*d/2,f=o.A.svg(n),u=A(e,{stroke:r.lineColor,fill:r.lineColor});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");let x=f.rectangle(c,p,h,d,u),w=n.insert(()=>x,":first-child");s&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",s),i&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",i),g(e,w);let b=l?.padding??0;return e.width&&e.height&&(e.width+=b/2||0,e.height+=b/2||0),e.intersect=function(t){return m(e,t)},n}async function tg(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(80,i.width+(e.padding??0)*2,e?.width??0),h=Math.max(50,i.height+(e.padding??0)*2,e?.height??0),c=h/2,{cssStyles:f}=e,m=o.A.svg(r),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:-n/2,y:-h/2},{x:n/2-c,y:-h/2},...u(-n/2+c,0,c,50,90,270),{x:n/2-c,y:h/2},{x:-n/2,y:h/2}],b=p(w),$=m.path(b,x),k=r.insert(()=>$,":first-child");return k.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",f),l&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",l),g(e,k),e.intersect=function(t){return s.Rm.info("Pill intersect",e,{radius:c,point:t}),_(e,w,t)},r}(0,s.K2)(tn,"cylinder"),(0,s.K2)(ts,"dividedRectangle"),(0,s.K2)(th,"doublecircle"),(0,s.K2)(to,"filledCircle"),(0,s.K2)(td,"flippedTriangle"),(0,s.K2)(tc,"forkJoin"),(0,s.K2)(tg,"halfRoundedRectangle");var ty=(0,s.K2)((t,e,a,l,r)=>`M${t+r},${e} L${t+a-r},${e} L${t+a},${e-l/2} L${t+a-r},${e-l} L${t+r},${e-l} L${t},${e-l/2} Z`,"createHexagonPathD");async function tp(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=n.height+e.padding,h=s/4,c=n.width+2*h+e.padding,p=[{x:h,y:0},{x:c-h,y:0},{x:c,y:-s/2},{x:c-h,y:-s},{x:h,y:-s},{x:0,y:-s/2}],{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=ty(0,0,c,s,h),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-c/2}, ${s/2})`),f&&a.attr("style",f)}else a=q(i,c,s,p);return r&&a.attr("style",r),e.width=c,e.height=s,g(e,a),e.intersect=function(t){return _(e,p,t)},i}async function tf(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.label="",e.labelStyle=a;let{shapeSvg:r}=await d(t,e,y(e)),i=Math.max(30,e?.width??0),n=Math.max(30,e?.height??0),{cssStyles:h}=e,c=o.A.svg(r),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let u=[{x:0,y:0},{x:i,y:0},{x:0,y:n},{x:i,y:n}],m=p(u),x=c.path(m,f),w=r.insert(()=>x,":first-child");return w.attr("class","basic label-container"),h&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",h),l&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",l),w.attr("transform",`translate(${-i/2}, ${-n/2})`),g(e,w),e.intersect=function(t){return s.Rm.info("Pill intersect",e,{points:u}),_(e,u,t)},r}async function tu(t,e,{config:{themeVariables:a,flowchart:l}}){let{labelStyles:i}=v(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48);e.width=Math.max(n,l?.wrappingWidth??0);let{shapeSvg:h,bbox:c,label:y}=await d(t,e,"icon-shape default"),p="t"===e.pos,{nodeBorder:f}=a,{stylesMap:u}=S(e),x=-n/2,w=-n/2,b=8*!!e.label,$=o.A.svg(h),k=A(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(k.roughness=0,k.fillStyle="solid");let M=$.rectangle(x,w,n,n,k),D=Math.max(n,c.width),K=n+c.height+b,C=$.rectangle(-D/2,-K/2,D,K,{...k,fill:"transparent",stroke:"none"}),B=h.insert(()=>M,":first-child"),L=h.insert(()=>C);if(e.icon){let t=h.append("g");t.html(`<g>${await (0,r.WY)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,o=a.y;t.attr("transform",`translate(${-l/2-s},${p?c.height/2+b/2-i/2-o:-c.height/2-b/2-i/2-o})`),t.attr("style",`color: ${u.get("stroke")??f};`)}return y.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${p?-K/2:K/2-c.height})`),B.attr("transform",`translate(0,${p?c.height/2+b/2:-c.height/2-b/2})`),g(e,L),e.intersect=function(t){if(s.Rm.info("iconSquare intersect",e,t),!e.label)return m(e,t);let a=e.x??0,l=e.y??0,r=e.height??0,i=[];return _(e,i=p?[{x:a-c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2+c.height+b},{x:a+n/2,y:l-r/2+c.height+b},{x:a+n/2,y:l+r/2},{x:a-n/2,y:l+r/2},{x:a-n/2,y:l-r/2+c.height+b},{x:a-c.width/2,y:l-r/2+c.height+b}]:[{x:a-n/2,y:l-r/2},{x:a+n/2,y:l-r/2},{x:a+n/2,y:l-r/2+n},{x:a+c.width/2,y:l-r/2+n},{x:a+c.width/2/2,y:l+r/2},{x:a-c.width/2,y:l+r/2},{x:a-c.width/2,y:l-r/2+n},{x:a-n/2,y:l-r/2+n}],t)},h}async function tm(t,e,{config:{themeVariables:a,flowchart:l}}){let{labelStyles:i}=v(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48);e.width=Math.max(n,l?.wrappingWidth??0);let{shapeSvg:h,bbox:c,label:y}=await d(t,e,"icon-shape default"),p=8*!!e.label,f="t"===e.pos,{nodeBorder:u,mainBkg:x}=a,{stylesMap:w}=S(e),b=o.A.svg(h),$=A(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid"),$.stroke=w.get("fill")??x;let k=h.append("g");e.icon&&k.html(`<g>${await (0,r.WY)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let M=k.node().getBBox(),D=M.width,K=M.height,C=M.x,B=M.y,L=Math.max(D,K)*Math.SQRT2+40,R=b.circle(0,0,L,$),N=Math.max(L,c.width),P=L+c.height+p,T=b.rectangle(-N/2,-P/2,N,P,{...$,fill:"transparent",stroke:"none"}),I=h.insert(()=>R,":first-child"),W=h.insert(()=>T);return k.attr("transform",`translate(${-D/2-C},${f?c.height/2+p/2-K/2-B:-c.height/2-p/2-K/2-B})`),k.attr("style",`color: ${w.get("stroke")??u};`),y.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${f?-P/2:P/2-c.height})`),I.attr("transform",`translate(0,${f?c.height/2+p/2:-c.height/2-p/2})`),g(e,W),e.intersect=function(t){return s.Rm.info("iconSquare intersect",e,t),m(e,t)},h}async function tx(t,e,{config:{themeVariables:a,flowchart:l}}){let{labelStyles:i}=v(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48);e.width=Math.max(n,l?.wrappingWidth??0);let{shapeSvg:h,bbox:c,halfPadding:y,label:p}=await d(t,e,"icon-shape default"),f="t"===e.pos,u=n+2*y,x=n+2*y,{nodeBorder:w,mainBkg:b}=a,{stylesMap:k}=S(e),M=8*!!e.label,D=o.A.svg(h),K=A(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid"),K.stroke=k.get("fill")??b;let C=D.path($(-x/2,-u/2,x,u,5),K),B=Math.max(x,c.width),L=u+c.height+M,R=D.rectangle(-B/2,-L/2,B,L,{...K,fill:"transparent",stroke:"none"}),N=h.insert(()=>C,":first-child").attr("class","icon-shape2"),P=h.insert(()=>R);if(e.icon){let t=h.append("g");t.html(`<g>${await (0,r.WY)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,o=a.y;t.attr("transform",`translate(${-l/2-s},${f?c.height/2+M/2-i/2-o:-c.height/2-M/2-i/2-o})`),t.attr("style",`color: ${k.get("stroke")??w};`)}return p.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${f?-L/2:L/2-c.height})`),N.attr("transform",`translate(0,${f?c.height/2+M/2:-c.height/2-M/2})`),g(e,P),e.intersect=function(t){if(s.Rm.info("iconSquare intersect",e,t),!e.label)return m(e,t);let a=e.x??0,l=e.y??0,r=e.height??0,i=[];return _(e,i=f?[{x:a-c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2+c.height+M},{x:a+x/2,y:l-r/2+c.height+M},{x:a+x/2,y:l+r/2},{x:a-x/2,y:l+r/2},{x:a-x/2,y:l-r/2+c.height+M},{x:a-c.width/2,y:l-r/2+c.height+M}]:[{x:a-x/2,y:l-r/2},{x:a+x/2,y:l-r/2},{x:a+x/2,y:l-r/2+u},{x:a+c.width/2,y:l-r/2+u},{x:a+c.width/2/2,y:l+r/2},{x:a-c.width/2,y:l+r/2},{x:a-c.width/2,y:l-r/2+u},{x:a-x/2,y:l-r/2+u}],t)},h}async function tw(t,e,{config:{themeVariables:a,flowchart:l}}){let{labelStyles:i}=v(e);e.labelStyle=i;let n=Math.max(e.assetHeight??48,e.assetWidth??48);e.width=Math.max(n,l?.wrappingWidth??0);let{shapeSvg:h,bbox:c,halfPadding:y,label:p}=await d(t,e,"icon-shape default"),f="t"===e.pos,u=n+2*y,x=n+2*y,{nodeBorder:w,mainBkg:b}=a,{stylesMap:k}=S(e),M=8*!!e.label,D=o.A.svg(h),K=A(e,{});"handDrawn"!==e.look&&(K.roughness=0,K.fillStyle="solid"),K.stroke=k.get("fill")??b;let C=D.path($(-x/2,-u/2,x,u,.1),K),B=Math.max(x,c.width),L=u+c.height+M,R=D.rectangle(-B/2,-L/2,B,L,{...K,fill:"transparent",stroke:"none"}),N=h.insert(()=>C,":first-child"),P=h.insert(()=>R);if(e.icon){let t=h.append("g");t.html(`<g>${await (0,r.WY)(e.icon,{height:n,width:n,fallbackPrefix:""})}</g>`);let a=t.node().getBBox(),l=a.width,i=a.height,s=a.x,o=a.y;t.attr("transform",`translate(${-l/2-s},${f?c.height/2+M/2-i/2-o:-c.height/2-M/2-i/2-o})`),t.attr("style",`color: ${k.get("stroke")??w};`)}return p.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${f?-L/2:L/2-c.height})`),N.attr("transform",`translate(0,${f?c.height/2+M/2:-c.height/2-M/2})`),g(e,P),e.intersect=function(t){if(s.Rm.info("iconSquare intersect",e,t),!e.label)return m(e,t);let a=e.x??0,l=e.y??0,r=e.height??0,i=[];return _(e,i=f?[{x:a-c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2},{x:a+c.width/2,y:l-r/2+c.height+M},{x:a+x/2,y:l-r/2+c.height+M},{x:a+x/2,y:l+r/2},{x:a-x/2,y:l+r/2},{x:a-x/2,y:l-r/2+c.height+M},{x:a-c.width/2,y:l-r/2+c.height+M}]:[{x:a-x/2,y:l-r/2},{x:a+x/2,y:l-r/2},{x:a+x/2,y:l-r/2+u},{x:a+c.width/2,y:l-r/2+u},{x:a+c.width/2/2,y:l+r/2},{x:a-c.width/2,y:l+r/2},{x:a-c.width/2,y:l-r/2+u},{x:a-x/2,y:l-r/2+u}],t)},h}async function tb(t,e,{config:{flowchart:a}}){let l=new Image;l.src=e?.img??"",await l.decode();let r=Number(l.naturalWidth.toString().replace("px","")),i=Number(l.naturalHeight.toString().replace("px",""));e.imageAspectRatio=r/i;let{labelStyles:n}=v(e);e.labelStyle=n;let h=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;let c=Math.max(e.label?h??0:0,e?.assetWidth??r),y="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:c,p="on"===e.constraint?y/e.imageAspectRatio:e?.assetHeight??i;e.width=Math.max(y,h??0);let{shapeSvg:f,bbox:u,label:x}=await d(t,e,"image-shape default"),w="t"===e.pos,b=-y/2,$=8*!!e.label,k=o.A.svg(f),S=A(e,{});"handDrawn"!==e.look&&(S.roughness=0,S.fillStyle="solid");let M=k.rectangle(b,-p/2,y,p,S),D=Math.max(y,u.width),K=p+u.height+$,C=k.rectangle(-D/2,-K/2,D,K,{...S,fill:"none",stroke:"none"}),B=f.insert(()=>M,":first-child"),L=f.insert(()=>C);if(e.img){let t=f.append("image");t.attr("href",e.img),t.attr("width",y),t.attr("height",p),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-y/2},${w?K/2-p:-K/2})`)}return x.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${w?-p/2-u.height/2-$/2:p/2-u.height/2+$/2})`),B.attr("transform",`translate(0,${w?u.height/2+$/2:-u.height/2-$/2})`),g(e,L),e.intersect=function(t){if(s.Rm.info("iconSquare intersect",e,t),!e.label)return m(e,t);let a=e.x??0,l=e.y??0,r=e.height??0,i=[];return _(e,i=w?[{x:a-u.width/2,y:l-r/2},{x:a+u.width/2,y:l-r/2},{x:a+u.width/2,y:l-r/2+u.height+$},{x:a+y/2,y:l-r/2+u.height+$},{x:a+y/2,y:l+r/2},{x:a-y/2,y:l+r/2},{x:a-y/2,y:l-r/2+u.height+$},{x:a-u.width/2,y:l-r/2+u.height+$}]:[{x:a-y/2,y:l-r/2},{x:a+y/2,y:l-r/2},{x:a+y/2,y:l-r/2+p},{x:a+u.width/2,y:l-r/2+p},{x:a+u.width/2/2,y:l+r/2},{x:a-u.width/2,y:l+r/2},{x:a-u.width/2,y:l-r/2+p},{x:a-y/2,y:l-r/2+p}],t)},f}async function t$(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=Math.max(n.width+(e.padding??0)*2,e?.width??0),h=Math.max(n.height+(e.padding??0)*2,e?.height??0),c=[{x:0,y:0},{x:s,y:0},{x:s+3*h/6,y:-h},{x:-3*h/6,y:-h}],{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=p(c),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),f&&a.attr("style",f)}else a=q(i,s,h,c);return r&&a.attr("style",r),e.width=s,e.height=h,g(e,a),e.intersect=function(t){return _(e,c,t)},i}async function tk(t,e,a){let l,{labelStyles:r,nodeStyles:i}=v(e);e.labelStyle=r;let{shapeSvg:s,bbox:h}=await d(t,e,y(e)),c=Math.max(h.width+2*a.labelPaddingX,e?.width||0),p=Math.max(h.height+2*a.labelPaddingY,e?.height||0),f=-c/2,u=-p/2,{rx:x,ry:w}=e,{cssStyles:b}=e;if(a?.rx&&a.ry&&(x=a.rx,w=a.ry),"handDrawn"===e.look){let t=o.A.svg(s),a=A(e,{}),r=x||w?t.path($(f,u,c,p,x||0),a):t.rectangle(f,u,c,p,a);(l=s.insert(()=>r,":first-child")).attr("class","basic label-container").attr("style",(0,n.KL)(b))}else(l=s.insert("rect",":first-child")).attr("class","basic label-container").attr("style",i).attr("rx",(0,n.KL)(x)).attr("ry",(0,n.KL)(w)).attr("x",f).attr("y",u).attr("width",c).attr("height",p);return g(e,l),e.intersect=function(t){return m(e,t)},s}async function tS(t,e){let{shapeSvg:a,bbox:l,label:r}=await d(t,e,"label"),i=a.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),r.attr("transform",`translate(${-(l.width/2)-(l.x-(l.left??0))}, ${-(l.height/2)-(l.y-(l.top??0))})`),g(e,i),e.intersect=function(t){return m(e,t)},a}async function tM(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=Math.max(n.width+(e.padding??0),e?.width??0),h=Math.max(n.height+(e.padding??0),e?.height??0),c=[{x:0,y:0},{x:s+3*h/6,y:0},{x:s,y:-h},{x:-(3*h)/6,y:-h}],{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=p(c),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),f&&a.attr("style",f)}else a=q(i,s,h,c);return r&&a.attr("style",r),e.width=s,e.height=h,g(e,a),e.intersect=function(t){return _(e,c,t)},i}async function tD(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=Math.max(n.width+(e.padding??0),e?.width??0),h=Math.max(n.height+(e.padding??0),e?.height??0),c=[{x:-3*h/6,y:0},{x:s,y:0},{x:s+3*h/6,y:-h},{x:0,y:-h}],{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=p(c),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),f&&a.attr("style",f)}else a=q(i,s,h,c);return r&&a.attr("style",r),e.width=s,e.height=h,g(e,a),e.intersect=function(t){return _(e,c,t)},i}function tv(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.label="",e.labelStyle=a;let r=t.insert("g").attr("class",y(e)).attr("id",e.domId??e.id),{cssStyles:i}=e,n=Math.max(35,e?.width??0),h=Math.max(35,e?.height??0),d=[{x:n,y:0},{x:0,y:h+3.5},{x:n-14,y:h+3.5},{x:0,y:2*h},{x:n,y:h-3.5},{x:14,y:h-3.5}],c=o.A.svg(r),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let u=p(d),m=c.path(u,f),x=r.insert(()=>m,":first-child");return i&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",i),l&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",l),x.attr("transform",`translate(-${n/2},${-h})`),g(e,x),e.intersect=function(t){return s.Rm.info("lightningBolt intersect",e,t),_(e,d,t)},r}(0,s.K2)(tp,"hexagon"),(0,s.K2)(tf,"hourglass"),(0,s.K2)(tu,"icon"),(0,s.K2)(tm,"iconCircle"),(0,s.K2)(tx,"iconRounded"),(0,s.K2)(tw,"iconSquare"),(0,s.K2)(tb,"imageSquare"),(0,s.K2)(t$,"inv_trapezoid"),(0,s.K2)(tk,"drawRect"),(0,s.K2)(tS,"labelRect"),(0,s.K2)(tM,"lean_left"),(0,s.K2)(tD,"lean_right"),(0,s.K2)(tv,"lightningBolt");var tA=(0,s.K2)((t,e,a,l,r,i,n)=>`M${t},${e+i} a${r},${i} 0,0,0 ${a},0 a${r},${i} 0,0,0 ${-a},0 l0,${l} a${r},${i} 0,0,0 ${a},0 l0,${-l} M${t},${e+i+n} a${r},${i} 0,0,0 ${a},0`,"createCylinderPathD"),tK=(0,s.K2)((t,e,a,l,r,i,n)=>`M${t},${e+i} M${t+a},${e+i} a${r},${i} 0,0,0 ${-a},0 l0,${l} a${r},${i} 0,0,0 ${a},0 l0,${-l} M${t},${e+i+n} a${r},${i} 0,0,0 ${a},0`,"createOuterCylinderPathD"),tC=(0,s.K2)((t,e,a,l,r,i)=>`M${t-a/2},${-l/2} a${r},${i} 0,0,0 ${a},0`,"createInnerCylinderPathD");async function tB(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:s,label:h}=await d(t,e,y(e)),c=Math.max(s.width+(e.padding??0),e.width??0),p=c/2,f=p/(2.5+c/50),u=Math.max(s.height+f+(e.padding??0),e.height??0),x=.1*u,{cssStyles:w}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=tK(0,0,c,u,p,f,x),r=tC(0,f,c,u,p,f),n=A(e,{}),s=t.path(l,n),h=t.path(r,n);i.insert(()=>h,":first-child").attr("class","line"),(a=i.insert(()=>s,":first-child")).attr("class","basic label-container"),w&&a.attr("style",w)}else{let t=tA(0,0,c,u,p,f,x);a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,n.KL)(w)).attr("style",r)}return a.attr("label-offset-y",f),a.attr("transform",`translate(${-c/2}, ${-(u/2+f)})`),g(e,a),h.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+f-(s.y-(s.top??0))})`),e.intersect=function(t){let a=m(e,t),l=a.x-(e.x??0);if(0!=p&&(Math.abs(l)<(e.width??0)/2||Math.abs(l)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-f)){let r=f*f*(1-l*l/(p*p));r>0&&(r=Math.sqrt(r)),r=f-r,t.y-(e.y??0)>0&&(r=-r),a.y+=r}return a},i}async function tL(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=h/4,p=h+c,{cssStyles:u}=e,m=o.A.svg(r),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:-s/2-s/2*.1,y:-p/2},{x:-s/2-s/2*.1,y:p/2},...f(-s/2-s/2*.1,p/2,s/2+s/2*.1,p/2,c,.8),{x:s/2+s/2*.1,y:-p/2},{x:-s/2-s/2*.1,y:-p/2},{x:-s/2,y:-p/2},{x:-s/2,y:p/2*1.1},{x:-s/2,y:-p/2}],b=m.polygon(w.map(t=>[t.x,t.y]),x),$=r.insert(()=>b,":first-child");return $.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",u),l&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",l),$.attr("transform",`translate(0,${-c/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)+s/2*.1/2-(i.x-(i.left??0))},${-h/2+(e.padding??0)-c/2-(i.y-(i.top??0))})`),g(e,$),e.intersect=function(t){return _(e,w,t)},r}async function tR(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=-s/2,f=-h/2,{cssStyles:u}=e,m=o.A.svg(r),x=A(e,{}),w=[{x:c-5,y:f+5},{x:c-5,y:f+h+5},{x:c+s-5,y:f+h+5},{x:c+s-5,y:f+h},{x:c+s,y:f+h},{x:c+s,y:f+h-5},{x:c+s+5,y:f+h-5},{x:c+s+5,y:f-5},{x:c+5,y:f-5},{x:c+5,y:f},{x:c,y:f},{x:c,y:f+5}];"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let b=p(w),$=m.path(b,x),k=p([{x:c,y:f+5},{x:c+s-5,y:f+5},{x:c+s-5,y:f+h},{x:c+s,y:f+h},{x:c+s,y:f},{x:c,y:f}]),S=m.path(k,{...x,fill:"none"}),M=r.insert(()=>S,":first-child");return M.insert(()=>$,":first-child"),M.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),l&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",l),n.attr("transform",`translate(${-(i.width/2)-5-(i.x-(i.left??0))}, ${-(i.height/2)+5-(i.y-(i.top??0))})`),g(e,M),e.intersect=function(t){return _(e,w,t)},r}async function tN(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=h/4,u=h+c,m=-s/2,x=-u/2,{cssStyles:w}=e,b=f(m-5,x+u+5,m+s-5,x+u+5,c,.8),$=b?.[b.length-1],k=[{x:m-5,y:x+5},{x:m-5,y:x+u+5},...b,{x:m+s-5,y:$.y-5},{x:m+s,y:$.y-5},{x:m+s,y:$.y-10},{x:m+s+5,y:$.y-10},{x:m+s+5,y:x-5},{x:m+5,y:x-5},{x:m+5,y:x},{x:m,y:x},{x:m,y:x+5}],S=[{x:m,y:x+5},{x:m+s-5,y:x+5},{x:m+s-5,y:$.y-5},{x:m+s,y:$.y-5},{x:m+s,y:x},{x:m,y:x}],M=o.A.svg(r),D=A(e,{});"handDrawn"!==e.look&&(D.roughness=0,D.fillStyle="solid");let K=p(k),C=M.path(K,D),B=p(S),L=M.path(B,D),R=r.insert(()=>C,":first-child");return R.insert(()=>L),R.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&R.selectAll("path").attr("style",w),l&&"handDrawn"!==e.look&&R.selectAll("path").attr("style",l),R.attr("transform",`translate(0,${-c/2})`),n.attr("transform",`translate(${-(i.width/2)-5-(i.x-(i.left??0))}, ${-(i.height/2)+5-c/2-(i.y-(i.top??0))})`),g(e,R),e.intersect=function(t){return _(e,k,t)},r}async function tP(t,e,{config:{themeVariables:a}}){let{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l,e.useHtmlLabels||(0,s.zj)().flowchart?.htmlLabels!==!1||(e.centerLabel=!0);let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),h=Math.max(n.width+(e.padding??0)*2,e?.width??0),c=Math.max(n.height+(e.padding??0)*2,e?.height??0),{cssStyles:p}=e,f=o.A.svg(i),u=A(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");let x=f.rectangle(-h/2,-c/2,h,c,u),w=i.insert(()=>x,":first-child");return w.attr("class","basic label-container"),p&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",p),r&&"handDrawn"!==e.look&&w.selectAll("path").attr("style",r),g(e,w),e.intersect=function(t){return m(e,t)},i}(0,s.K2)(tB,"linedCylinder"),(0,s.K2)(tL,"linedWaveEdgedRect"),(0,s.K2)(tR,"multiRect"),(0,s.K2)(tN,"multiWaveEdgedRectangle"),(0,s.K2)(tP,"note");var tT=(0,s.K2)((t,e,a)=>`M${t+a/2},${e} L${t+a},${e-a/2} L${t+a/2},${e-a} L${t},${e-a/2} Z`,"createDecisionBoxPathD");async function tI(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),h=n.width+e.padding+(n.height+e.padding),c=[{x:h/2,y:0},{x:h,y:-h/2},{x:h/2,y:-h},{x:0,y:-h/2}],{cssStyles:p}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=tT(0,0,h),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-h/2}, ${h/2})`),p&&a.attr("style",p)}else a=q(i,h,h,c);return r&&a.attr("style",r),g(e,a),e.intersect=function(t){return s.Rm.debug("APA12 Intersect called SPLIT\npoint:",t,"\nnode:\n",e,"\nres:",_(e,c,t)),_(e,c,t)},i}async function tW(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0),e?.width??0),h=Math.max(i.height+(e.padding??0),e?.height??0),c=-s/2,f=-h/2,u=f/2,m=[{x:c+u,y:f},{x:c,y:0},{x:c+u,y:-f},{x:-c,y:-f},{x:-c,y:f}],{cssStyles:x}=e,w=o.A.svg(r),b=A(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");let $=p(m),k=w.path($,b),S=r.insert(()=>k,":first-child");return S.attr("class","basic label-container"),x&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",x),l&&"handDrawn"!==e.look&&S.selectAll("path").attr("style",l),S.attr("transform",`translate(${-u/2},0)`),n.attr("transform",`translate(${-u/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),g(e,S),e.intersect=function(t){return _(e,m,t)},r}async function tE(t,e){let a,l,r,{labelStyles:i,nodeStyles:n}=v(e);e.labelStyle=i,a=e.cssClasses?"node "+e.cssClasses:"node default";let d=t.insert("g").attr("class",a).attr("id",e.domId||e.id),c=d.insert("g"),y=d.insert("g").attr("class","label").attr("style",n),p=e.description,f=e.label,u=y.node().appendChild(await b(f,e.labelStyle,!0,!0)),x={width:0,height:0};if((0,s._3)((0,s.D7)()?.flowchart?.htmlLabels)){let t=u.children[0],e=(0,h.Ltv)(u);x=t.getBoundingClientRect(),e.attr("width",x.width),e.attr("height",x.height)}s.Rm.info("Text 2",p);let w=p||[],k=u.getBBox(),S=y.node().appendChild(await b(w.join?w.join("<br/>"):w,e.labelStyle,!0,!0)),M=S.children[0],D=(0,h.Ltv)(S);x=M.getBoundingClientRect(),D.attr("width",x.width),D.attr("height",x.height);let K=(e.padding||0)/2;(0,h.Ltv)(S).attr("transform","translate( "+(x.width>k.width?0:(k.width-x.width)/2)+", "+(k.height+K+5)+")"),(0,h.Ltv)(u).attr("transform","translate( "+(x.width<k.width?0:-(k.width-x.width)/2)+", 0)"),x=y.node().getBBox(),y.attr("transform","translate("+-x.width/2+", "+(-x.height/2-K+3)+")");let C=x.width+(e.padding||0),B=x.height+(e.padding||0),L=-x.width/2-K,R=-x.height/2-K;if("handDrawn"===e.look){let t=o.A.svg(d),a=A(e,{}),i=t.path($(L,R,C,B,e.rx||0),a),n=t.line(-x.width/2-K,-x.height/2-K+k.height+K,x.width/2+K,-x.height/2-K+k.height+K,a);r=d.insert(()=>(s.Rm.debug("Rough node insert CXC",i),n),":first-child"),l=d.insert(()=>(s.Rm.debug("Rough node insert CXC",i),i),":first-child")}else l=c.insert("rect",":first-child"),r=c.insert("line"),l.attr("class","outer title-state").attr("style",n).attr("x",-x.width/2-K).attr("y",-x.height/2-K).attr("width",x.width+(e.padding||0)).attr("height",x.height+(e.padding||0)),r.attr("class","divider").attr("x1",-x.width/2-K).attr("x2",x.width/2+K).attr("y1",-x.height/2-K+k.height+K).attr("y2",-x.height/2-K+k.height+K);return g(e,l),e.intersect=function(t){return m(e,t)},d}async function tj(t,e){let a={rx:5,ry:5,classes:"",labelPaddingX:+(e?.padding||0),labelPaddingY:+(e?.padding||0)};return tk(t,e,a)}async function t_(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:s}=await d(t,e,y(e)),h=e?.padding??0,c=Math.max(i.width+(e.padding??0)*2,e?.width??0),p=Math.max(i.height+(e.padding??0)*2,e?.height??0),f=-i.width/2-h,u=-i.height/2-h,{cssStyles:x}=e,w=o.A.svg(r),b=A(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");let $=w.polygon([{x:f,y:u},{x:f+c+8,y:u},{x:f+c+8,y:u+p},{x:f-8,y:u+p},{x:f-8,y:u},{x:f,y:u},{x:f,y:u+p}].map(t=>[t.x,t.y]),b),k=r.insert(()=>$,":first-child");return k.attr("class","basic label-container").attr("style",(0,n.KL)(x)),l&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",l),x&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",l),s.attr("transform",`translate(${-c/2+4+(e.padding??0)-(i.x-(i.left??0))},${-p/2+(e.padding??0)-(i.y-(i.top??0))})`),g(e,k),e.intersect=function(t){return m(e,t)},r}async function tH(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=-s/2,f=-h/2,{cssStyles:u}=e,m=o.A.svg(r),x=A(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let w=[{x:c,y:f},{x:c,y:f+h},{x:c+s,y:f+h},{x:c+s,y:f-h/2}],b=p(w),$=m.path(b,x),k=r.insert(()=>$,":first-child");return k.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",u),l&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",l),k.attr("transform",`translate(0, ${h/4})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))}, ${-h/4+(e.padding??0)-(i.y-(i.top??0))})`),g(e,k),e.intersect=function(t){return _(e,w,t)},r}async function tz(t,e){let a={rx:0,ry:0,classes:"",labelPaddingX:2*(e?.padding||0),labelPaddingY:+(e?.padding||0)};return tk(t,e,a)}async function tF(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:s}=await d(t,e,y(e)),h=s.height+e.padding,c=s.width+h/4+e.padding,{cssStyles:p}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=$(-c/2,-h/2,c,h,h/2),s=t.path(r,l);(a=i.insert(()=>s,":first-child")).attr("class","basic label-container").attr("style",(0,n.KL)(p))}else(a=i.insert("rect",":first-child")).attr("class","basic label-container").attr("style",r).attr("rx",h/2).attr("ry",h/2).attr("x",-c/2).attr("y",-h/2).attr("width",c).attr("height",h);return g(e,a),e.intersect=function(t){return m(e,t)},i}async function tq(t,e){return tk(t,e,{rx:5,ry:5,classes:"flowchart-node"})}function tO(t,e,{config:{themeVariables:a}}){let{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{cssStyles:i}=e,{lineColor:n,stateBorder:s,nodeBorder:h}=a,d=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),c=o.A.svg(d),y=A(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");let p=c.circle(0,0,14,{...y,stroke:n,strokeWidth:2}),f=s??h,u=c.circle(0,0,5,{...y,fill:f,stroke:f,strokeWidth:2,fillStyle:"solid"}),m=d.insert(()=>p,":first-child");return m.insert(()=>u),i&&m.selectAll("path").attr("style",i),r&&m.selectAll("path").attr("style",r),g(e,m),e.intersect=function(t){return W(e,7,t)},d}function tZ(t,e,{config:{themeVariables:a}}){let l,{lineColor:r}=a,i=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);if("handDrawn"===e.look){let t=o.A.svg(i).circle(0,0,14,k(r));(l=i.insert(()=>t)).attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else(l=i.insert("circle",":first-child")).attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return g(e,l),e.intersect=function(t){return W(e,7,t)},i}async function tX(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),s=(e?.padding||0)/2,h=i.width+e.padding,c=i.height+e.padding,p=-i.width/2-s,f=-i.height/2-s,u=[{x:0,y:0},{x:h,y:0},{x:h,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:h+8,y:0},{x:h+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if("handDrawn"===e.look){let t=o.A.svg(r),a=A(e,{}),l=t.rectangle(p-8,f,h+16,c,a),i=t.line(p,f,p,f+c,a),s=t.line(p+h,f,p+h,f+c,a);r.insert(()=>i,":first-child"),r.insert(()=>s,":first-child");let d=r.insert(()=>l,":first-child"),{cssStyles:y}=e;d.attr("class","basic label-container").attr("style",(0,n.KL)(y)),g(e,d)}else{let t=q(r,h,c,u);l&&t.attr("style",l),g(e,t)}return e.intersect=function(t){return _(e,u,t)},r}async function tY(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(i.width+(e.padding??0)*2,e?.width??0),s=Math.max(i.height+(e.padding??0)*2,e?.height??0),h=-n/2,c=-s/2,f=.2*s,{cssStyles:u}=e,m=o.A.svg(r),x=A(e,{}),w=[{x:h-f/2,y:c},{x:h+n+f/2,y:c},{x:h+n+f/2,y:c+s},{x:h-f/2,y:c+s}];"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");let b=p(w),$=m.path(b,x),k=p([{x:h+n-f/2,y:c+s},{x:h+n+f/2,y:c+s},{x:h+n+f/2,y:c+s-.2*s}]),S=m.path(k,{...x,fillStyle:"solid"}),M=r.insert(()=>S,":first-child");return M.insert(()=>$,":first-child"),M.attr("class","basic label-container"),u&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",u),l&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",l),g(e,M),e.intersect=function(t){return _(e,w,t)},r}async function tG(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=h/4,u=.2*s,m=.2*h,x=h+c,{cssStyles:w}=e,b=o.A.svg(r),$=A(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let k=[{x:-s/2-s/2*.1,y:x/2},...f(-s/2-s/2*.1,x/2,s/2+s/2*.1,x/2,c,.8),{x:s/2+s/2*.1,y:-x/2},{x:-s/2-s/2*.1,y:-x/2}],S=-s/2+s/2*.1,M=-x/2-.4*m,D=[{x:S+s-u,y:(M+h)*1.4},{x:S+s,y:M+h-m},{x:S+s,y:(M+h)*.9},...f(S+s,(M+h)*1.3,S+s-u,(M+h)*1.5,-(.03*h),.5)],K=p(k),C=b.path(K,$),B=p(D),L=b.path(B,{...$,fillStyle:"solid"}),R=r.insert(()=>L,":first-child");return R.insert(()=>C,":first-child"),R.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&R.selectAll("path").attr("style",w),l&&"handDrawn"!==e.look&&R.selectAll("path").attr("style",l),R.attr("transform",`translate(0,${-c/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))},${-h/2+(e.padding??0)-c/2-(i.y-(i.top??0))})`),g(e,R),e.intersect=function(t){return _(e,k,t)},r}async function tU(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(i.width+e.padding,e?.width||0),s=Math.max(i.height+e.padding,e?.height||0),h=r.insert("rect",":first-child");return h.attr("class","text").attr("style",l).attr("rx",0).attr("ry",0).attr("x",-n/2).attr("y",-s/2).attr("width",n).attr("height",s),g(e,h),e.intersect=function(t){return m(e,t)},r}(0,s.K2)(tI,"question"),(0,s.K2)(tW,"rect_left_inv_arrow"),(0,s.K2)(tE,"rectWithTitle"),(0,s.K2)(tj,"roundedRect"),(0,s.K2)(t_,"shadedProcess"),(0,s.K2)(tH,"slopedRect"),(0,s.K2)(tz,"squareRect"),(0,s.K2)(tF,"stadium"),(0,s.K2)(tq,"state"),(0,s.K2)(tO,"stateEnd"),(0,s.K2)(tZ,"stateStart"),(0,s.K2)(tX,"subroutine"),(0,s.K2)(tY,"taggedRect"),(0,s.K2)(tG,"taggedWaveEdgedRectangle"),(0,s.K2)(tU,"text");var tV=(0,s.K2)((t,e,a,l,r,i)=>`M${t},${e}
    a${r},${i} 0,0,1 0,${-l}
    l${a},0
    a${r},${i} 0,0,1 0,${l}
    M${a},${-l}
    a${r},${i} 0,0,0 0,${l}
    l${-a},0`,"createCylinderPathD"),tJ=(0,s.K2)((t,e,a,l,r,i)=>`M${t},${e} M${t+a},${e} a${r},${i} 0,0,0 0,${-l} l${-a},0 a${r},${i} 0,0,0 0,${l} l${a},0`,"createOuterCylinderPathD"),tQ=(0,s.K2)((t,e,a,l,r,i)=>`M${t+a/2},${-l/2} a${r},${i} 0,0,0 0,${l}`,"createInnerCylinderPathD");async function t0(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:s,label:h,halfPadding:c}=await d(t,e,y(e)),p="neo"===e.look?2*c:c,f=s.height+p,u=f/2,x=u/(2.5+f/50),w=s.width+x+p,{cssStyles:b}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=tJ(0,0,w,f,x,u),r=tQ(0,0,w,f,x,u),n=t.path(l,A(e,{})),s=t.path(r,A(e,{fill:"none"}));a=i.insert(()=>s,":first-child"),(a=i.insert(()=>n,":first-child")).attr("class","basic label-container"),b&&a.attr("style",b)}else{let t=tV(0,0,w,f,x,u);(a=i.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",(0,n.KL)(b)).attr("style",r)).attr("class","basic label-container"),b&&a.selectAll("path").attr("style",b),r&&a.selectAll("path").attr("style",r)}return a.attr("label-offset-x",x),a.attr("transform",`translate(${-w/2}, ${f/2} )`),h.attr("transform",`translate(${-(s.width/2)-x-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),g(e,a),e.intersect=function(t){let a=m(e,t),l=a.y-(e.y??0);if(0!=u&&(Math.abs(l)<(e.height??0)/2||Math.abs(l)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-x)){let r=x*x*(1-l*l/(u*u));0!=r&&(r=Math.sqrt(Math.abs(r))),r=x-r,t.x-(e.x??0)>0&&(r=-r),a.x+=r}return a},i}async function t2(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let{shapeSvg:i,bbox:n}=await d(t,e,y(e)),s=n.width+e.padding,h=n.height+e.padding,c=[{x:-3*h/6,y:0},{x:s+3*h/6,y:0},{x:s,y:-h},{x:0,y:-h}],{cssStyles:f}=e;if("handDrawn"===e.look){let t=o.A.svg(i),l=A(e,{}),r=p(c),n=t.path(r,l);a=i.insert(()=>n,":first-child").attr("transform",`translate(${-s/2}, ${h/2})`),f&&a.attr("style",f)}else a=q(i,s,h,c);return r&&a.attr("style",r),e.width=s,e.height=h,g(e,a),e.intersect=function(t){return _(e,c,t)},i}async function t1(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(60,i.width+(e.padding??0)*2,e?.width??0),s=Math.max(20,i.height+(e.padding??0)*2,e?.height??0),{cssStyles:h}=e,c=o.A.svg(r),f=A(e,{});"handDrawn"!==e.look&&(f.roughness=0,f.fillStyle="solid");let u=[{x:-n/2*.8,y:-s/2},{x:n/2*.8,y:-s/2},{x:n/2,y:-s/2*.6},{x:n/2,y:s/2},{x:-n/2,y:s/2},{x:-n/2,y:-s/2*.6}],m=p(u),x=c.path(m,f),w=r.insert(()=>x,":first-child");return w.attr("class","basic label-container"),h&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",h),l&&"handDrawn"!==e.look&&w.selectChildren("path").attr("style",l),g(e,w),e.intersect=function(t){return _(e,u,t)},r}async function t5(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),h=(0,s._3)((0,s.D7)().flowchart?.htmlLabels),c=i.width+(e.padding??0),f=c+i.height,u=c+i.height,m=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-f}],{cssStyles:x}=e,w=o.A.svg(r),b=A(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");let $=p(m),k=w.path($,b),S=r.insert(()=>k,":first-child").attr("transform",`translate(${-f/2}, ${f/2})`);return x&&"handDrawn"!==e.look&&S.selectChildren("path").attr("style",x),l&&"handDrawn"!==e.look&&S.selectChildren("path").attr("style",l),e.width=c,e.height=f,g(e,S),n.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${f/2-(i.height+(e.padding??0)/(h?2:1)-(i.y-(i.top??0)))})`),e.intersect=function(t){return s.Rm.info("Triangle intersect",e,m,t),_(e,m,t)},r}async function t8(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=h/8,u=h+c,{cssStyles:m}=e,x=70-s,w=x>0?x/2:0,b=o.A.svg(r),$=A(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let k=[{x:-s/2-w,y:u/2},...f(-s/2-w,u/2,s/2+w,u/2,c,.8),{x:s/2+w,y:-u/2},{x:-s/2-w,y:-u/2}],S=p(k),M=b.path(S,$),D=r.insert(()=>M,":first-child");return D.attr("class","basic label-container"),m&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",m),l&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",l),D.attr("transform",`translate(0,${-c/2})`),n.attr("transform",`translate(${-s/2+(e.padding??0)-(i.x-(i.left??0))},${-h/2+(e.padding??0)-c-(i.y-(i.top??0))})`),g(e,D),e.intersect=function(t){return _(e,k,t)},r}async function t7(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i}=await d(t,e,y(e)),n=Math.max(i.width+(e.padding??0)*2,e?.width??0),s=Math.max(i.height+(e.padding??0)*2,e?.height??0),h=n/s,c=n,u=s;c>u*h?u=c/h:c=u*h,c=Math.max(c,100);let m=Math.min(.2*(u=Math.max(u,50)),u/4),x=u+2*m,{cssStyles:w}=e,b=o.A.svg(r),$=A(e,{});"handDrawn"!==e.look&&($.roughness=0,$.fillStyle="solid");let k=[{x:-c/2,y:x/2},...f(-c/2,x/2,c/2,x/2,m,1),{x:c/2,y:-x/2},...f(c/2,-x/2,-c/2,-x/2,m,-1)],S=p(k),M=b.path(S,$),D=r.insert(()=>M,":first-child");return D.attr("class","basic label-container"),w&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",w),l&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",l),g(e,D),e.intersect=function(t){return _(e,k,t)},r}async function t3(t,e){let{labelStyles:a,nodeStyles:l}=v(e);e.labelStyle=a;let{shapeSvg:r,bbox:i,label:n}=await d(t,e,y(e)),s=Math.max(i.width+(e.padding??0)*2,e?.width??0),h=Math.max(i.height+(e.padding??0)*2,e?.height??0),c=-s/2,p=-h/2,{cssStyles:f}=e,u=o.A.svg(r),m=A(e,{}),x=[{x:c-5,y:p-5},{x:c-5,y:p+h},{x:c+s,y:p+h},{x:c+s,y:p-5}],w=`M${c-5},${p-5} L${c+s},${p-5} L${c+s},${p+h} L${c-5},${p+h} L${c-5},${p-5}
                M${c-5},${p} L${c+s},${p}
                M${c},${p-5} L${c},${p+h}`;"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");let b=u.path(w,m),$=r.insert(()=>b,":first-child");return $.attr("transform","translate(2.5, 2.5)"),$.attr("class","basic label-container"),f&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",f),l&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",l),n.attr("transform",`translate(${-(i.width/2)+2.5-(i.x-(i.left??0))}, ${-(i.height/2)+2.5-(i.y-(i.top??0))})`),g(e,$),e.intersect=function(t){return _(e,x,t)},r}async function t4(t,e){if(e.alias&&(e.label=e.alias),"handDrawn"===e.look){let{themeVariables:a}=(0,s.zj)(),{background:l}=a,r={...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${l}`]};await t4(t,r)}let a=(0,s.zj)();e.useHtmlLabels=a.htmlLabels;let l=a.er?.diagramPadding??10,r=a.er?.entityPadding??6,{cssStyles:i}=e,{labelStyles:d}=v(e);if(0===e.attributes.length&&e.label){let r={rx:0,ry:0,labelPaddingX:l,labelPaddingY:1.5*l,classes:""};(0,n.Un)(e.label,a)+2*r.labelPaddingX<a.er.minEntityWidth&&(e.width=a.er.minEntityWidth);let i=await tk(t,e,r);if(!(0,s._3)(a.htmlLabels)){let t=i.select("text"),e=t.node()?.getBBox();t.attr("transform",`translate(${-e.width/2}, 0)`)}return i}a.htmlLabels||(l*=1.25,r*=1.25);let c=y(e);c||(c="node default");let p=t.insert("g").attr("class",c).attr("id",e.domId||e.id),f=await t9(p,e.label??"",a,0,0,["name"],d);f.height+=r;let u=0,x=[],w=0,b=0,$=0,k=0,S=!0,M=!0;for(let t of e.attributes){let e=await t9(p,t.type,a,0,u,["attribute-type"],d);w=Math.max(w,e.width+l);let i=await t9(p,t.name,a,0,u,["attribute-name"],d);b=Math.max(b,i.width+l);let n=await t9(p,t.keys.join(),a,0,u,["attribute-keys"],d);$=Math.max($,n.width+l);let s=await t9(p,t.comment,a,0,u,["attribute-comment"],d);k=Math.max(k,s.width+l),u+=Math.max(e.height,i.height,n.height,s.height)+r,x.push(u)}x.pop();let D=4;$<=l&&(S=!1,$=0,D--),k<=l&&(M=!1,k=0,D--);let K=p.node().getBBox();if(f.width+2*l-(w+b+$+k)>0){let t=f.width+2*l-(w+b+$+k);w+=t/D,b+=t/D,$>0&&($+=t/D),k>0&&(k+=t/D)}let C=w+b+$+k,B=o.A.svg(p),L=A(e,{});"handDrawn"!==e.look&&(L.roughness=0,L.fillStyle="solid");let R=Math.max(K.width+2*l,e?.width||0,C),N=Math.max(K.height+(x[0]||u)+r,e?.height||0),P=-R/2,T=-N/2;p.selectAll("g:not(:first-child)").each((t,e,a)=>{let i=(0,h.Ltv)(a[e]),n=i.attr("transform"),s=0,o=0;if(n){let t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(n);t&&(s=parseFloat(t[1]),o=parseFloat(t[2]),i.attr("class").includes("attribute-name")?s+=w:i.attr("class").includes("attribute-keys")?s+=w+b:i.attr("class").includes("attribute-comment")&&(s+=w+b+$))}i.attr("transform",`translate(${P+l/2+s}, ${o+T+f.height+r/2})`)}),p.select(".name").attr("transform","translate("+-f.width/2+", "+(T+r/2)+")");let I=B.rectangle(P,T,R,N,L),W=p.insert(()=>I,":first-child").attr("style",i.join("")),{themeVariables:E}=(0,s.zj)(),{rowEven:j,rowOdd:_,nodeBorder:H}=E;for(let[t,e]of(x.push(0),x.entries())){if(0===t&&x.length>1)continue;let a=t%2==0&&0!==e,l=B.rectangle(P,f.height+T+e,R,f.height,{...L,fill:a?j:_,stroke:H});p.insert(()=>l,"g.label").attr("style",i.join("")).attr("class",`row-rect-${t%2==0?"even":"odd"}`)}let z=B.line(P,f.height+T,R+P,f.height+T,L);for(let t of(p.insert(()=>z).attr("class","divider"),z=B.line(w+P,f.height+T,w+P,N+T,L),p.insert(()=>z).attr("class","divider"),S&&(z=B.line(w+b+P,f.height+T,w+b+P,N+T,L),p.insert(()=>z).attr("class","divider")),M&&(z=B.line(w+b+$+P,f.height+T,w+b+$+P,N+T,L),p.insert(()=>z).attr("class","divider")),x))z=B.line(P,f.height+T+t,R+P,f.height+T+t,L),p.insert(()=>z).attr("class","divider");return g(e,W),e.intersect=function(t){return m(e,t)},p}async function t9(t,e,a,l=0,r=0,o=[],d=""){let c=t.insert("g").attr("class",`label ${o.join(" ")}`).attr("transform",`translate(${l}, ${r})`).attr("style",d);e!==(0,s.QO)(e)&&(e=(e=(0,s.QO)(e)).replaceAll("<","&lt;").replaceAll(">","&gt;"));let g=c.node().appendChild(await (0,i.GZ)(c,e,{width:(0,n.Un)(e,a)+100,style:d,useHtmlLabels:a.htmlLabels},a));if(e.includes("&lt;")||e.includes("&gt;")){let t=g.children[0];for(t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");t.childNodes[0];)(t=t.childNodes[0]).textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let y=g.getBBox();if((0,s._3)(a.htmlLabels)){let t=g.children[0];t.style.textAlign="start";let e=(0,h.Ltv)(g);y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}return y}async function t6(t,e,a,l,r=a.class.padding??12){let i=3*!l,n=t.insert("g").attr("class",y(e)).attr("id",e.domId||e.id),s=null,h=null,o=null,d=null,c=0,g=0,p=0;if(s=n.insert("g").attr("class","annotation-group text"),e.annotations.length>0){let t=e.annotations[0];await et(s,{text:`\xab${t}\xbb`},0),c=s.node().getBBox().height}h=n.insert("g").attr("class","label-group text"),await et(h,e,0,["font-weight: bolder"]);let f=h.node().getBBox();g=f.height,o=n.insert("g").attr("class","members-group text");let u=0;for(let t of e.members){let e=await et(o,t,u,[t.parseClassifier()]);u+=e+i}(p=o.node().getBBox().height)<=0&&(p=r/2),d=n.insert("g").attr("class","methods-group text");let m=0;for(let t of e.methods){let e=await et(d,t,m,[t.parseClassifier()]);m+=e+i}let x=n.node().getBBox();if(null!==s){let t=s.node().getBBox();s.attr("transform",`translate(${-t.width/2})`)}return h.attr("transform",`translate(${-f.width/2}, ${c})`),x=n.node().getBBox(),o.attr("transform",`translate(0, ${c+g+2*r})`),x=n.node().getBBox(),d.attr("transform",`translate(0, ${c+g+(p?p+4*r:2*r)})`),x=n.node().getBBox(),{shapeSvg:n,bbox:x}}async function et(t,e,a,l=[]){let r,o=t.insert("g").attr("class","label").attr("style",l.join("; ")),d=(0,s.zj)(),c="useHtmlLabels"in e?e.useHtmlLabels:(0,s._3)(d.htmlLabels)??!0,g="";g="text"in e?e.text:e.label,!c&&g.startsWith("\\")&&(g=g.substring(1)),(0,s.Wi)(g)&&(c=!0);let y=await (0,i.GZ)(o,(0,s.oB)((0,n.Sm)(g)),{width:(0,n.Un)(g,d)+50,classes:"markdown-node-label",useHtmlLabels:c},d),p=1;if(c){let t=y.children[0],e=(0,h.Ltv)(y);p=t.innerHTML.split("<br>").length,t.innerHTML.includes("</math>")&&(p+=t.innerHTML.split("<mrow>").length-1);let a=t.getElementsByTagName("img");if(a){let t=""===g.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function l(){if(e.style.display="flex",e.style.flexDirection="column",t){let t=5*parseInt(d.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,10)+"px";e.style.minWidth=t,e.style.maxWidth=t}else e.style.width="100%";a(e)}(0,s.K2)(l,"setupImage"),setTimeout(()=>{e.complete&&l()}),e.addEventListener("error",l),e.addEventListener("load",l)})))}r=t.getBoundingClientRect(),e.attr("width",r.width),e.attr("height",r.height)}else{l.includes("font-weight: bolder")&&(0,h.Ltv)(y).selectAll("tspan").attr("font-weight",""),p=y.children.length;let t=y.children[0];(""===y.textContent||y.textContent.includes("&gt"))&&(t.textContent=g[0]+g.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim()," "===g[1]&&(t.textContent=t.textContent[0]+" "+t.textContent.substring(1))),"undefined"===t.textContent&&(t.textContent=""),r=y.getBBox()}return o.attr("transform","translate(0,"+(-r.height/(2*p)+a)+")"),r.height}async function ee(t,e){let a=(0,s.D7)(),l=a.class.padding??12,r=e.useHtmlLabels??(0,s._3)(a.htmlLabels)??!0;e.annotations=e.annotations??[],e.members=e.members??[],e.methods=e.methods??[];let{shapeSvg:i,bbox:n}=await t6(t,e,a,r,l),{labelStyles:d,nodeStyles:c}=v(e);e.labelStyle=d,e.cssStyles=e.styles||"";let y=e.styles?.join(";")||c||"";e.cssStyles||(e.cssStyles=y.replaceAll("!important","").split(";"));let p=0===e.members.length&&0===e.methods.length&&!a.class?.hideEmptyMembersBox,f=o.A.svg(i),u=A(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");let x=n.width,w=n.height;0===e.members.length&&0===e.methods.length?w+=l:e.members.length>0&&0===e.methods.length&&(w+=2*l);let b=-x/2,$=-w/2,k=f.rectangle(b-l,$-l-(p?l:0===e.members.length&&0===e.methods.length?-l/2:0),x+2*l,w+2*l+(p?2*l:0===e.members.length&&0===e.methods.length?-l:0),u),S=i.insert(()=>k,":first-child");S.attr("class","basic label-container");let M=S.node().getBBox();i.selectAll(".text").each((t,a,n)=>{let s=(0,h.Ltv)(n[a]),o=s.attr("transform"),d=0;if(o){let t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(o);t&&(d=parseFloat(t[2]))}let c=d+$+l-(p?l:0===e.members.length&&0===e.methods.length?-l/2:0);r||(c-=4);let g=b;(s.attr("class").includes("label-group")||s.attr("class").includes("annotation-group"))&&(g=-s.node()?.getBBox().width/2||0,i.selectAll("text").each(function(t,e,a){"middle"===window.getComputedStyle(a[e]).textAnchor&&(g=0)})),s.attr("transform",`translate(${g}, ${c})`)});let D=i.select(".annotation-group").node().getBBox().height-(p?l/2:0)||0,K=i.select(".label-group").node().getBBox().height-(p?l/2:0)||0,C=i.select(".members-group").node().getBBox().height-(p?l/2:0)||0;if(e.members.length>0||e.methods.length>0||p){let t=f.line(M.x,D+K+$+l,M.x+M.width,D+K+$+l,u);i.insert(()=>t).attr("class","divider").attr("style",y)}if(p||e.members.length>0||e.methods.length>0){let t=f.line(M.x,D+K+C+$+2*l+l,M.x+M.width,D+K+C+$+l+2*l,u);i.insert(()=>t).attr("class","divider").attr("style",y)}if("handDrawn"!==e.look&&i.selectAll("path").attr("style",y),S.select(":nth-child(2)").attr("style",y),i.selectAll(".divider").select("path").attr("style",y),e.labelStyle?i.selectAll("span").attr("style",e.labelStyle):i.selectAll("span").attr("style",y),!r){let t=RegExp(/color\s*:\s*([^;]*)/),e=t.exec(y);if(e){let t=e[0].replace("color","fill");i.selectAll("tspan").attr("style",t)}else if(d){let e=t.exec(d);if(e){let t=e[0].replace("color","fill");i.selectAll("tspan").attr("style",t)}}}return g(e,S),e.intersect=function(t){return m(e,t)},i}async function ea(t,e){let a,{labelStyles:l,nodeStyles:r}=v(e);e.labelStyle=l;let i="verifyMethod"in e,n=y(e),s=t.insert("g").attr("class",n).attr("id",e.domId??e.id),d=a=i?await el(s,`&lt;&lt;${e.type}&gt;&gt;`,0,e.labelStyle):await el(s,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle),c=await el(s,e.name,d,e.labelStyle+"; font-weight: bold;");if(d+=c+20,i){let t=await el(s,`${e.requirementId?`Id: ${e.requirementId}`:""}`,d,e.labelStyle);d+=t;let a=await el(s,`${e.text?`Text: ${e.text}`:""}`,d,e.labelStyle);d+=a;let l=await el(s,`${e.risk?`Risk: ${e.risk}`:""}`,d,e.labelStyle);d+=l,await el(s,`${e.verifyMethod?`Verification: ${e.verifyMethod}`:""}`,d,e.labelStyle)}else{let t=await el(s,`${e.type?`Type: ${e.type}`:""}`,d,e.labelStyle);d+=t,await el(s,`${e.docRef?`Doc Ref: ${e.docRef}`:""}`,d,e.labelStyle)}let p=(s.node()?.getBBox().width??200)+20,f=(s.node()?.getBBox().height??200)+20,u=-p/2,x=-f/2,w=o.A.svg(s),b=A(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");let $=w.rectangle(u,x,p,f,b),k=s.insert(()=>$,":first-child");if(k.attr("class","basic label-container").attr("style",r),s.selectAll(".label").each((t,e,a)=>{let l=(0,h.Ltv)(a[e]),r=l.attr("transform"),i=0,n=0;if(r){let t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(r);t&&(i=parseFloat(t[1]),n=parseFloat(t[2]))}let s=n-f/2,o=u+10;(0===e||1===e)&&(o=i),l.attr("transform",`translate(${o}, ${s+20})`)}),d>a+c+20){let t=w.line(u,x+a+c+20,u+p,x+a+c+20,b);s.insert(()=>t).attr("style",r)}return g(e,k),e.intersect=function(t){return m(e,t)},s}async function el(t,e,a,l=""){let r;if(""===e)return 0;let o=t.insert("g").attr("class","label").attr("style",l),d=(0,s.D7)(),c=d.htmlLabels??!0,g=await (0,i.GZ)(o,(0,s.oB)((0,n.Sm)(e)),{width:(0,n.Un)(e,d)+50,classes:"markdown-node-label",useHtmlLabels:c,style:l},d);if(c){let t=g.children[0],e=(0,h.Ltv)(g);r=t.getBoundingClientRect(),e.attr("width",r.width),e.attr("height",r.height)}else{for(let t of g.children[0].children)t.textContent=t.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),l&&t.setAttribute("style",l);r=g.getBBox(),r.height+=6}return o.attr("transform",`translate(${-r.width/2},${-r.height/2+a})`),r.height}(0,s.K2)(t0,"tiltedCylinder"),(0,s.K2)(t2,"trapezoid"),(0,s.K2)(t1,"trapezoidalPentagon"),(0,s.K2)(t5,"triangle"),(0,s.K2)(t8,"waveEdgedRectangle"),(0,s.K2)(t7,"waveRectangle"),(0,s.K2)(t3,"windowPane"),(0,s.K2)(t4,"erBox"),(0,s.K2)(t9,"addText"),(0,s.K2)(t6,"textHelper"),(0,s.K2)(et,"addText"),(0,s.K2)(ee,"classBox"),(0,s.K2)(ea,"requirementBox"),(0,s.K2)(el,"addText");var er=(0,s.K2)(t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function ei(t,e,{config:a}){let l,r,i,n,{labelStyles:s,nodeStyles:h}=v(e);e.labelStyle=s||"";let p=e.width;e.width=(e.width??200)-10;let{shapeSvg:f,bbox:u,label:x}=await d(t,e,y(e)),w=e.padding||10,b="";"ticket"in e&&e.ticket&&a?.kanban?.ticketBaseUrl&&(b=a?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),l=f.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",b).attr("target","_blank"));let k={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};l?{label:r,bbox:i}=await c(l,"ticket"in e&&e.ticket||"",k):{label:r,bbox:i}=await c(f,"ticket"in e&&e.ticket||"",k);let{label:S,bbox:M}=await c(f,"assigned"in e&&e.assigned||"",k);e.width=p;let D=e?.width||0,K=Math.max(i.height,M.height)/2,C=Math.max(u.height+20,e?.height||0)+K,B=-D/2,L=-C/2;x.attr("transform","translate("+(w-D/2)+", "+(-K-u.height/2)+")"),r.attr("transform","translate("+(w-D/2)+", "+(-K+u.height/2)+")"),S.attr("transform","translate("+(w+D/2-M.width-20)+", "+(-K+u.height/2)+")");let{rx:R,ry:N}=e,{cssStyles:P}=e;if("handDrawn"===e.look){let t=o.A.svg(f),a=A(e,{}),l=R||N?t.path($(B,L,D,C,R||0),a):t.rectangle(B,L,D,C,a);(n=f.insert(()=>l,":first-child")).attr("class","basic label-container").attr("style",P||null)}else{(n=f.insert("rect",":first-child")).attr("class","basic label-container __APA__").attr("style",h).attr("rx",R??5).attr("ry",N??5).attr("x",B).attr("y",L).attr("width",D).attr("height",C);let t="priority"in e&&e.priority;if(t){let e=f.append("line"),a=B+2,l=L+Math.floor((R??0)/2),r=L+C-Math.floor((R??0)/2);e.attr("x1",a).attr("y1",l).attr("x2",a).attr("y2",r).attr("stroke-width","4").attr("stroke",er(t))}}return g(e,n),e.height=C,e.intersect=function(t){return m(e,t)},f}(0,s.K2)(ei,"kanbanItem");var en=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:tz},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:tj},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:tF},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:tX},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:tn},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:X},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:tI},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:tp},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:tD},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:tM},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:t2},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:t$},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:th},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:tU},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:O},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:t_},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:tZ},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:tO},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:tc},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:tf},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:V},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Q},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:te},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:tv},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:t8},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:tg},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:t0},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:tB},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ta},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:ts},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:t5},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:t3},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:to},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:t1},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:td},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:tH},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:tN},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:tR},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:F},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:G},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:tG},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:tY},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:t7},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:tW},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:tL}],es=(0,s.K2)(()=>Object.fromEntries([...Object.entries({state:tq,choice:Z,note:tP,rectWithTitle:tE,labelRect:tS,iconSquare:tw,iconCircle:tm,icon:tu,iconRounded:tx,imageSquare:tb,anchor:H,kanbanItem:ei,classBox:ee,erBox:t4,requirementBox:ea}),...en.flatMap(t=>[t.shortName,..."aliases"in t?t.aliases:[],..."internalAliases"in t?t.internalAliases:[]].map(e=>[e,t.handler]))]),"generateShapeMap")();function eh(t){return t in es}(0,s.K2)(eh,"isValidShape");var eo=new Map;async function ed(t,e,a){let l,r;"rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");let i=e.shape?es[e.shape]:void 0;if(!i)throw Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let n;"sandbox"===a.config.securityLevel?n="_top":e.linkTarget&&(n=e.linkTarget||"_blank"),l=t.insert("svg:a").attr("xlink:href",e.link).attr("target",n??null),r=await i(l,e,a)}else l=r=await i(t,e,a);return e.tooltip&&r.attr("title",e.tooltip),eo.set(e.id,l),e.haveCallback&&l.attr("class",l.attr("class")+" clickable"),l}(0,s.K2)(ed,"insertNode");var ec=(0,s.K2)((t,e)=>{eo.set(e.id,t)},"setNodeElem"),eg=(0,s.K2)(()=>{eo.clear()},"clear"),ey=(0,s.K2)(t=>{let e=eo.get(t.id);s.Rm.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");let a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a},"positionNode")}}]);